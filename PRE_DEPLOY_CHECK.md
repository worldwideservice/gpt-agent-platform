# üîç Pre-Deploy Checklist - –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

**–î–∞—Ç–∞:** 2025-01-02  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

---

## ‚úÖ 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (Registration API)

### Backend (`app/api/auth/register/route.ts`)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π (email, password, firstName, lastName)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email (regex)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (bcrypt, 12 rounds)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (try-catch –≤–µ–∑–¥–µ)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `getSupabaseServiceRoleClient()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ `process.env`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –≤–∞–ª–∏–¥–∞—Ü–∏—è env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `loadSupabaseServerEnv()`

### Frontend (`app/(auth)/register/RegisterClient.tsx`)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
- ‚úÖ Kwid –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## ‚úÖ 2. Supabase –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ `lib/supabase/admin.ts` - Service Role –∫–ª–∏–µ–Ω—Ç
- ‚úÖ `lib/supabase/client.ts` - Browser –∫–ª–∏–µ–Ω—Ç
- ‚úÖ `lib/env/supabase.ts` - –í–∞–ª–∏–¥–∞—Ü–∏—è env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### –¢–∞–±–ª–∏—Ü—ã –ë–î
- ‚úÖ `users` - —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ `organizations` - —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ `organization_members` - —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ `notifications` - —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `supabase/migrations/`

---

## ‚úÖ 3. TypeScript –û—à–∏–±–∫–∏ (–ù–ï –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

### –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏):
1. `KwidSelect` –Ω–µ –∏–º–µ–µ—Ç `placeholder` prop - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ AgentEditForm
2. `KwidBadge` variant="primary" - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "default"
3. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `AgentTrainingPage` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (—É–¥–∞–ª–µ–Ω —Ä–∞–Ω–µ–µ)
4. –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ –≤ knowledge-categories/page.tsx

**–≠—Ç–∏ –æ—à–∏–±–∫–∏ –ù–ï –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞.**

---

## ‚úÖ 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫

### API Routes
- ‚úÖ `/api/auth/register` - –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ try-catch –±–ª–æ–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å—ã (400, 409, 500)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚úÖ `UserRepository.createUser()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ `UserRepository.findUserByEmail()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ `createNotification()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## ‚úÖ 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–∞—Ä–æ–ª–∏
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ bcrypt —Å 12 rounds
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –ù–ï —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è

### Environment Variables
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `loadSupabaseServerEnv()`
- ‚úÖ –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ `process.env` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ `.env` –≤ `.gitignore`
- ‚úÖ `env.production` –≤ `.gitignore`

### –î–∞–Ω–Ω—ã–µ
- ‚úÖ Email –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è (toLowerCase, trim)
- ‚úÖ –ò–º–µ–Ω–∞ —Ç—Ä–∏–º—è—Ç—Å—è
- ‚úÖ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã (Supabase ORM)

---

## ‚úÖ 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –î–∞–Ω–Ω—ã—Ö

### –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email (regex)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## ‚úÖ 7. –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã
```sql
‚úÖ users              - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚úÖ organizations      - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚úÖ organization_members - —Å–≤—è–∑–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
‚úÖ notifications     - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚úÖ password_resets   - —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π
‚úÖ subscriptions     - –ø–æ–¥–ø–∏—Å–∫–∏
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `supabase/migrations/`
- ‚úÖ –°—Ö–µ–º–∞ –≤ `supabase/schema.sql`
- ‚úÖ Seed –¥–∞–Ω–Ω—ã–µ –≤ `supabase/seed.sql`

---

## ‚úÖ 8. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### Backend
- ‚úÖ `createNotification()` —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### Frontend
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –†–µ–∞–ª-—Ç–∞–π–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (WebSocket)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã

---

## ‚úÖ 9. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –í—Ö–æ–¥ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (`last_sign_in_at`)

---

## ‚úÖ 10. Environment Variables

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
- ‚úÖ `SUPABASE_URL` - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `SUPABASE_SERVICE_ROLE_KEY` - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `NEXTAUTH_SECRET` - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `NEXTAUTH_URL` - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –§–∞–π–ª —Å–æ–∑–¥–∞–Ω
‚úÖ .env —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

# –í–∞–ª–∏–¥–∞—Ü–∏—è
‚úÖ loadSupabaseServerEnv() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–ù–ï –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

1. **TypeScript –æ—à–∏–±–∫–∏** –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é)
   - KwidSelect placeholder prop
   - KwidBadge variant="primary"
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç AgentTrainingPage (–±—ã–ª —É–¥–∞–ª–µ–Ω)

2. **–≠—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç:**
   - ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
   - ‚úÖ –í—Ö–æ–¥
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   - ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–ø–ª–æ—é

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: ‚úÖ –ì–û–¢–û–í–ê
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–ª–Ω–∞—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è
- ‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –í—Ö–æ–¥: ‚úÖ –ì–û–¢–û–í
- ‚úÖ NextAuth —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ‚úÖ –ì–û–¢–û–í–ê
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ô –í–ï–†–î–ò–ö–¢

**–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–ê –ö –î–ï–ü–õ–û–Æ!** üéâ

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î

**–ù–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ TypeScript –æ—à–∏–±–∫–∏** –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞.

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. ‚úÖ **–ú–æ–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ)
3. ‚úÖ –í—Å–µ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
4. ‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ! üöÄ**

