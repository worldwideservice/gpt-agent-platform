# Дизайн-система TON 18

Документ фиксирует текущие дизайн-токены, правила синхронизации с Tailwind и shadcn/ui, а также процесс сопровождения макетов, доступности и бренд-активов.

## 1. Дизайн-токены

### 1.1 Цвета и семантика

| Токен | CSS-переменная | Значение (light) | Значение (dark) | Назначение |
| --- | --- | --- | --- | --- |
| `background` | `--background` | `0 0% 100%` | `0 0% 3.9%` | Базовый фон страниц |
| `foreground` | `--foreground` | `0 0% 3.9%` | `0 0% 98%` | Базовый текст |
| `primary` | `--primary` | `0 0% 9%` | `0 0% 98%` | Акцент шрифта/иконок в базовых компонентах |
| `secondary` | `--secondary` | `0 0% 96.1%` | `0 0% 14.9%` | Вторичные поверхности |
| `muted` | `--muted` | `0 0% 96.1%` | `0 0% 14.9%` | Подложки карточек |
| `accent` | `--accent` | `0 0% 96.1%` | `0 0% 14.9%` | Hover-состояния |
| `destructive` | `--destructive` | `0 84.2% 60.2%` | `0 62.8% 30.6%` | Ошибки |
| `border` | `--border` | `0 0% 89.8%` | `0 0% 14.9%` | Бордеры и разделители |
| `ring` | `--ring` | `0 0% 3.9%` | `0 0% 83.1%` | Фокус-стили |
| `brand.accent` | `--brand-accent` | `355 78% 56%` | `356 86% 62%` | Главный брендовый акцент |
| `brand.accentStrong` | `--brand-accent-strong` | `16 100% 60%` | `16 100% 65%` | Поддерживающий градиент |
| `brand.accentForeground` | `--brand-accent-foreground` | `0 0% 100%` | `0 0% 98%` | Контрастный текст на брендовых фонах |
| `brand.focus` | `--focus-ring` | `355 78% 56%` | `356 86% 62%` | Цвет колец фокуса |
| `chart.1–5` | `--chart-1..5` | см. `app/globals.css` | см. `app/globals.css` | Цвета для аналитических графиков |

Базовая палитра (`basePalette`) с оттенками `custom`, `primary`, `gray` сохранена в `design-tokens.ts` и автоматически попадает в Tailwind.

### 1.2 Радиусы, шрифты и брейкпоинты

- Радиусы: `--radius` (0.5rem) с производными `lg`, `md`, `sm` в `radiusTokens`.
- Шрифт: `fontTokens.sans = Inter` (используется через Tailwind `font-sans`).
- Глобальные брейкпоинты управляются Tailwind по умолчанию (`sm`, `md`, `lg`, `xl`, `2xl`).

### 1.3 Соглашения

1. Любой новый токен добавляется в `design-tokens.ts` → экспортируется в `tailwind.config.ts` → прокидывается в CSS-переменные (`app/globals.css`).
2. Значения цвета в компонентах **не хардкодятся** — используем классы вида `bg-brand-accent`, `ring-brand-focus`, `text-brand-accentForeground`.
3. Для градиентов допускается прямое обращение к переменным: `from-[hsl(var(--brand-accent))]`.

## 2. Синхронизация с Tailwind и shadcn/ui

### 2.1 Tailwind

- Конфиг: `tailwind.config.ts` импортирует `basePalette`, `semanticColorTokens`, `chartColorTokens`, `radiusTokens`, `fontTokens`, `brandTokens` и прокидывает их в `theme.extend.colors`/`borderRadius`/`fontFamily`.
- Для обновления токенов:
  1. Обновить `design-tokens.ts`.
  2. Проверить `tailwind.config.ts` (должны быть добавлены новые ключи).
  3. Пересоздать CSS-переменные в `app/globals.css`.
  4. Запустить `npm run lint` и смоук-осмотр Storybook (опционально) для проверки классов.

### 2.2 shadcn/ui

- Базовые стили shadcn опираются на `--background`, `--foreground`, `--primary` и др. Мы расширили кнопки, диалоги и прочие компоненты через Tailwind-классы.
- Для шад-системы используем хелпер `buttonVariants` в `components/ui/Button.tsx`, который теперь возвращает брендовые цвета и единый фокус-стиль (`focus-visible:ring-brand-focus`).
- При добавлении новых компонентов shadcn импортируйте их через `components/ui/shadcn/*` и заменяйте хардкоды цветов на токены.

## 3. Figma и макеты

- Исходные UX-описания лежат в каталоге `references-kwid/` (подробные отчёты по страницам и состояниям). Используйте их как единственный источник правок макетов.
- При обновлении макетов в Figma:
  1. Создайте страницы **Desktop / Tablet / Mobile** с привязкой к токенам (используйте стили цвета `brand/accent`, `Neutral/Background` и т. д.).
  2. Отразите интерактивные состояния для кнопок (`default`, `hover`, `focus-visible`, `disabled`) и ссылок с теми же значениями, что и в коде.
  3. Для компонентов shadcn фиксируйте состояния раскрытия (`accordion`, `dropdown`, `dialog`) с учётом токенов `surface`, `border`, `shadow`.
  4. Экспортируйте обновлённые стили/компоненты в библиотеку Figma, указав источник `docs/design-system.md` и ссылку на конкретные отчёты из `references-kwid`.

## 4. Аудит доступности

Проверка охватила контраст, клавиатурную навигацию и aria-атрибуты.

| Компонент | Проблема | Решение |
| --- | --- | --- |
| `Button` | Не было видимого фокуса, использовались чёрные цвета без связи с токенами | Добавлен единый фокус-стиль (`focus-visible:ring-brand-focus`), переход на брендовые цвета, дефолтный `type="button"` для предотвращения неожиданной отправки форм. |
| `ThemeToggle` | В исходном состоянии отсутствовали aria-атрибуты и фокус-стили | Добавлены `aria-label`, `aria-pressed`, `aria-hidden` для иконок и использование брендового hover-фона. |
| CTA-кнопки на лендинге | Вложенные `button` внутри `a` нарушали семантику | Переведены на `Button` с `asChild`, обновлены стили и фокусы. |
| Футер и ссылки | Хардкод цветов и недостаточный контраст | Заменены на брендовые токены, улучшен контраст hover-состояний. |

Рекомендуемые проверки перед релизом: `npm run lint`, `npm run test:responsive`, `npm run test:accessibility` (по мере необходимости).

## 5. Бренд-активы

Новые активы находятся в `public/brand/`:

| Файл | Назначение |
| --- | --- |
| `logo-wordmark-light.svg` / `logo-wordmark-dark.svg` | Основной логотип для светлой/тёмной тем |
| `logo-mark.svg` | Компактный знак (иконка, фавиконы, мобильный сайдбар) |
| `hero-illustration.svg` | Иллюстрация для hero-секции публичных страниц |
| `icon-spark.svg` | Мини-иконка, которую можно использовать в бейджах и подсветке преимуществ |

Компонент `Logo` автоматически переключает нужный ассет по текущей теме. Для лендинга добавлена иллюстрация в hero-блоке.

## 6. Процесс обновления дизайна

1. **Внести изменения** в токены/переменные.
2. **Обновить документацию** (настоящий файл), Tailwind и CSS.
3. **Синхронизировать макеты** в Figma, используя `references-kwid` как исходную спецификацию. При необходимости прикрепить ссылки на новые компоненты в комментариях.
4. **Проверить доступность**: клавиатурный фокус, aria-описания, контраст (WCAG AA ≥ 4.5:1 для текста, 3:1 для UI-элементов).
5. **Экспортировать бренд-активы** (SVG, PNG) в `public/brand/` и обновить ссылки в компонентах.
6. **Запустить автоматические проверки** и визуальный осмотр основных страниц (Landing, Pricing, Docs, Auth).

Следуя этим шагам, команда поддерживает единый источник правды по визуальной части и минимизирует рассинхронизацию между макетами и кодом.
