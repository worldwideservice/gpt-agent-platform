# Alertmanager Configuration
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –∞–ª–µ—Ä—Ç–∞—Ö
#
# –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï:
# 1. –î–ª—è Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SMTP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∏–∂–µ
# 2. –î–ª—è Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - –¥–æ–±–∞–≤—å—Ç–µ webhook URL –≤ —Å–µ–∫—Ü–∏—é slack_configs
# 3. –î–ª—è Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ URL –≤ —Å–µ–∫—Ü–∏–∏ webhook_configs

global:
  resolve_timeout: 5m
  # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SMTP –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
  # smtp_smarthost: 'smtp.gmail.com:587'
  # smtp_from: 'alerts@yourdomain.com'
  # smtp_auth_username: 'your-email@gmail.com'
  # smtp_auth_password: 'your-app-password'
  # 
  # –ü—Ä–∏–º–µ—Ä—ã SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:
  # - Gmail: smtp.gmail.com:587
  # - SendGrid: smtp.sendgrid.net:587
  # - Mailgun: smtp.mailgun.org:587
  # - AWS SES: email-smtp.region.amazonaws.com:587

# –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤
route:
  receiver: 'default'
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  routes:
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
    - match:
        severity: critical
      receiver: 'critical-alerts'
      continue: true
    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è
    - match:
        severity: warning
      receiver: 'warning-alerts'
      group_wait: 30s
      group_interval: 5m

# –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
receivers:
  - name: 'default'
    webhook_configs:
      - url: 'http://localhost:5001/webhook'
        send_resolved: true

  - name: 'critical-alerts'
    # Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
    # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
    # email_configs:
    #   - to: 'admin@yourdomain.com'
    #     headers:
    #       Subject: 'üö® Critical Alert: {{ .GroupLabels.alertname }}'
    #     html: |
    #       <h2>Critical Alert</h2>
    #       <p><strong>Alert:</strong> {{ .GroupLabels.alertname }}</p>
    #       <p><strong>Description:</strong> {{ range .Alerts }}{{ .Annotations.description }}{{ end }}</p>
    #       <p><strong>Time:</strong> {{ .Alerts[0].StartsAt }}</p>
    webhook_configs:
      # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook URL –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Discord, Telegram, etc.)
      # - url: 'https://your-webhook-url.com/alerts'
      #   send_resolved: true
      - url: 'http://localhost:5001/webhook'
        send_resolved: true
    # Slack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
    # –ü–æ–ª—É—á–∏—Ç–µ webhook URL: https://api.slack.com/messaging/webhooks
    # slack_configs:
    #   - api_url: 'YOUR_SLACK_WEBHOOK_URL'
    #     channel: '#alerts'
    #     title: 'üö® Critical Alert'
    #     text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'
    #     send_resolved: true

  - name: 'warning-alerts'
    webhook_configs:
      - url: 'http://localhost:5001/webhook'
        send_resolved: true
    # Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    # email_configs:
    #   - to: 'team@yourdomain.com'
    #     headers:
    #       Subject: 'Warning: {{ .GroupLabels.alertname }}'

# –ò–Ω–≥–∏–±–∏—Ç–æ—Ä—ã (–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∞–ª–µ—Ä—Ç–æ–≤)
inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'cluster', 'service']

