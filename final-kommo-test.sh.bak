#!/bin/bash
echo "üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢ KOMMO –ò–ù–¢–ï–ì–†–ê–¶–ò–ò"
echo "=================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:"
grep -E "KOMMO_TEST_(ENABLED|ACCESS_TOKEN|REFRESH_TOKEN)" .env.local || echo "‚ùå –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

echo ""
echo "üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ API:"
if command -v npx &> /dev/null; then
    DOTENV_CONFIG_PATH=./.env.local npx tsx test-kommo.ts
else
    echo "‚ùå npx –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js"
    exit 1
fi

echo ""
echo "‚úÖ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!"
EOF && chmod +x final-kommo-test.sh && echo "‚úÖ –°–æ–∑–¥–∞–Ω final-kommo-test.sh"