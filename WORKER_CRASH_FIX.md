# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–¥–µ–Ω–∏—è Worker

**–î–∞—Ç–∞:** 2025-01-26  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö Railway:**
```
SyntaxError: The requested module '@sentry/profiling-node' does not provide an export named 'ProfilingIntegration'
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –∏–º–ø–æ—Ä—Ç `ProfilingIntegration` –∏–∑ `@sentry/profiling-node`
- –í Sentry v8 —ç—Ç–æ—Ç —ç–∫—Å–ø–æ—Ä—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É
- Worker –ø–∞–¥–∞–ª –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `services/worker/src/lib/sentry.ts`:**

1. **–£–¥–∞–ª–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç:**
   ```typescript
   // ‚ùå –ë—ã–ª–æ:
   import { ProfilingIntegration } from '@sentry/profiling-node'
   
   // ‚úÖ –°—Ç–∞–ª–æ:
   // (–∏–º–ø–æ—Ä—Ç —É–¥–∞–ª–µ–Ω)
   ```

2. **–£–¥–∞–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ProfilingIntegration:**
   ```typescript
   // ‚ùå –ë—ã–ª–æ:
   integrations: [
     new ProfilingIntegration(),
     new Sentry.Integrations.Http({ tracing: true }),
   ],
   
   // ‚úÖ –°—Ç–∞–ª–æ:
   integrations: [
     new Sentry.Integrations.Http({ tracing: true }),
   ],
   ```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –í Sentry v8 profiling –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–∞–∫–µ—Ç–∞ `@sentry/profiling-node` –≤ dependencies
- –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `profilesSampleRate` profiling –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –Ø–≤–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `ProfilingIntegration` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É

---

## üöÄ –î–µ–ø–ª–æ–π

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- ‚úÖ –°–±–æ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ main branch
- ‚úÖ Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∞–ª –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π

**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è:** 2-5 –º–∏–Ω—É—Ç

---

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health Check:**
   ```bash
   curl https://gpt-agent-platform-production.up.railway.app/health
   ```

2. **Metrics endpoints:**
   ```bash
   curl https://gpt-agent-platform-production.up.railway.app/metrics
   curl https://gpt-agent-platform-production.up.railway.app/metrics/prometheus
   ```

3. **–õ–æ–≥–∏ Railway:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Worker –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- ‚úÖ Worker –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ endpoints –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ Sentry profiling –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (10% sampling)
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –≤ –ª–æ–≥–∞—Ö

