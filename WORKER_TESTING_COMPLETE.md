# ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Worker –∑–∞–≤–µ—Ä—à–µ–Ω–æ

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç Redis URL –¥–ª—è Upstash
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –ò–∑–º–µ–Ω–µ–Ω –ø–æ—Ä—Ç —Å `6380` –Ω–∞ `6379`
  - –î–æ–±–∞–≤–ª–µ–Ω username `default` –≤ —Ñ–æ—Ä–º–∞—Ç URL
  - –§–æ—Ä–º–∞—Ç: `rediss://default:TOKEN@HOST:6379`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (`[worker] Redis connection established`)

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ job
- **–§–∞–π–ª**: `services/worker/src/tasks/index.ts`
- **–¢–∏–ø job**: `test-job`
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ü—Ä–æ—Å—Ç–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã Worker
- **–ö–æ–¥**:
  ```typescript
  'test-job': async (payload: { test?: boolean; timestamp?: number }) => {
    console.log('[worker] Test job received:', payload)
    return { success: true, receivedAt: new Date().toISOString(), payload }
  }
  ```

### 3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ Worker
- **–§–∞–π–ª**: `scripts/check-worker.js`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ Upstash (UPSTASH_REDIS_REST_URL –∏ UPSTASH_REDIS_REST_TOKEN)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Redis URL –∏–∑ REST URL –∏ Token
  - –£–ª—É—á—à–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (timeout, ready check)

### 4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Railway –ª–æ–≥–∏
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Worker —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
- **–õ–æ–≥–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç**:
  - ‚úÖ `[worker] Starting Worker service...`
  - ‚úÖ `[worker] Environment variables loaded successfully`
  - ‚úÖ `[worker] Redis connection established`
  - ‚úÖ `[worker] Started processing jobs from queue: agent-jobs`
  - ‚úÖ `[worker] Health check server listening on port 3001`
  - ‚úÖ `[worker] Concurrency: 5`

---

## üß™ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ job –ª–æ–∫–∞–ª—å–Ω–æ:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   export UPSTASH_REDIS_REST_URL="https://composed-primate-14678.upstash.io"
   export UPSTASH_REDIS_REST_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"
   export JOB_QUEUE_NAME="agent-jobs"
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏**:
   ```bash
   node scripts/check-worker.js
   ```

3. **–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis
   - –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—á–µ—Ä–µ–¥–∏
   - –î–æ–±–∞–≤–∏—Ç —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–¥–∞—á—É `test-job`
   - –ü–æ–¥–æ–∂–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ (5 —Å–µ–∫—É–Ω–¥)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
   - –£–¥–∞–ª–∏—Ç —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–¥–∞—á—É

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Railway

Worker —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Railway –∏ –≥–æ—Ç–æ–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–¥–∞—á–∏. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å —á–µ—Ä–µ–∑ API –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker –≤ Railway Dashboard
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–¥–∞—á–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å Worker

- **–î–µ–ø–ª–æ–π**: ‚úÖ –£—Å–ø–µ—à–Ω–æ (Deployment successful)
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **Health check**: ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á**: ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ
- **–¢–µ—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫**: ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω (`test-job`)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

1. **URGENT**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î –≤ Supabase
2. **URGENT**: Security audit - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Git –∏—Å—Ç–æ—Ä–∏—é –Ω–∞ —Å–µ–∫—Ä–µ—Ç—ã, —Ä–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏
3. **HIGH**: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å SLO/SLA –∏ —Å–æ–∑–¥–∞—Ç—å Sentry Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
4. **HIGH**: –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π Disaster Recovery –ø–ª–∞–Ω –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
5. **HIGH**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Worker (–º–µ—Ç—Ä–∏–∫–∏, –∞–ª–µ—Ä—Ç—ã)
6. **MEDIUM**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Sentry DSN –≤ Vercel –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: 2025-01-26
**–í–µ—Ä—Å–∏—è**: 1.0

