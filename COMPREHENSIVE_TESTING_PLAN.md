# üß™ –ü–ª–∞–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**–î–∞—Ç–∞:** 2025-01-26  
**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω

---

## ‚úÖ –£–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

### Frontend (Vercel)
- ‚úÖ Health Check (`/api/health`)
- ‚úÖ Ready Check (`/api/health/ready`)
- ‚úÖ Main Page (`/`)
- ‚úÖ Database connection

### Worker (Railway)
- ‚úÖ Health Check (`/health`)
- ‚úÖ Metrics JSON (`/metrics`)
- ‚úÖ Prometheus Metrics (`/metrics/prometheus`)
- ‚úÖ Redis connection
- ‚úÖ Sentry integration (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)

---

## üîç –ß—Ç–æ –µ—â–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. **End-to-End Job Processing** ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á

**–¢–µ—Å—Ç—ã:**
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ API (`POST /api/jobs`)
- [ ] –ó–∞–¥–∞—á–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å Redis
- [ ] Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- [ ] –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–¢–∏–ø—ã –∑–∞–¥–∞—á –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- `process-asset` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å—Å–µ—Ç–æ–≤
- `extract-knowledge-graph` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
curl -X POST https://gpt-agent-kwid.vercel.app/api/jobs \
  -H "Content-Type: application/json" \
  -d '{"type": "process-asset", "assetId": "test-uuid", "organizationId": "test-org-uuid"}'

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ Worker (–¥–æ–ª–∂–Ω—ã —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è jobs_total)
curl https://gpt-agent-platform-production.up.railway.app/metrics

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Worker (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á–∏)
```

---

### 2. **Frontend API Endpoints** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ API endpoints

**Endpoints –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- [ ] `/api/auth/signin` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [ ] `/api/integrations/kommo/status` - —Å—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Kommo
- [ ] `/api/crm/kommo?action=pipelines` - CRM –¥–∞–Ω–Ω—ã–µ
- [ ] `/api/subscriptions` - –ø–æ–¥–ø–∏—Å–∫–∏
- [ ] `/api/agents` - –∞–≥–µ–Ω—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] `/api/jobs` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á (POST)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å endpoints
curl https://gpt-agent-kwid.vercel.app/api/auth/signin
curl https://gpt-agent-kwid.vercel.app/api/integrations/kommo/status
curl https://gpt-agent-kwid.vercel.app/api/crm/kommo?action=pipelines
```

---

### 3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- [ ] **Supabase** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î (—É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ health)
- [ ] **Upstash Redis** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis (—É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- [ ] **OpenRouter** - API –¥–ª—è LLM (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ health)
- [ ] **Kommo CRM** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
- [ ] **Sentry** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# Supabase - —á–µ—Ä–µ–∑ Frontend health
curl https://gpt-agent-kwid.vercel.app/api/health | grep database

# Redis - —á–µ—Ä–µ–∑ Worker health
curl https://gpt-agent-platform-production.up.railway.app/health | grep redis

# OpenRouter - —á–µ—Ä–µ–∑ Frontend health
curl https://gpt-agent-kwid.vercel.app/api/health | grep openrouter
```

---

### 4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ê–ª–µ—Ä—Ç—ã** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] **UptimeRobot** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- [ ] **Sentry** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- [ ] **Prometheus Metrics** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- [ ] **Health Checks** - –≤—Å–µ endpoints –æ—Ç–≤–µ—á–∞—é—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# Prometheus metrics
curl https://gpt-agent-platform-production.up.railway.app/metrics/prometheus

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Sentry (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω SENTRY_DSN)
# –õ–æ–≥–∏ Worker –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Sentry
```

---

### 5. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- [ ] Frontend (Vercel) - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Worker (Railway) - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
  - `SUPABASE_URL`, `SUPABASE_ANON_KEY`
  - `UPSTASH_REDIS_REST_URL`, `UPSTASH_REDIS_REST_TOKEN`
  - `OPENROUTER_API_KEY`
  - `SENTRY_DSN` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
./scripts/check-env-production.sh
```

---

### 6. **–ë—ç–∫–∞–ø—ã** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –±—ç–∫–∞–ø–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] –°–∫—Ä–∏–ø—Ç –±—ç–∫–∞–ø–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (`scripts/backup-database.sh`)
- [ ] Cron job –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ë—ç–∫–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- [ ] –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã
bash -n scripts/backup-database.sh
bash -n scripts/cleanup-old-backups.sh
bash -n scripts/check-backup-status.sh
```

---

### 7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ù–∞–≥—Ä—É–∑–∫–∞** ‚ö†Ô∏è –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –Ω–∞–≥—Ä—É–∑–∫–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] Worker concurrency –Ω–∞—Å—Ç—Ä–æ–µ–Ω (25)
- [ ] Redis connection pool –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Database connection pool –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å concurrency Worker
curl https://gpt-agent-platform-production.up.railway.app/metrics | grep concurrency
```

---

### 8. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚ö†Ô∏è –í–ê–ñ–ù–û
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã –≤ –∫–æ–¥–µ (—É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- [ ] HTTPS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (—Å–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å)
1. **End-to-End Job Processing** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á
2. **Frontend API Endpoints** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints
3. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### üü° –í–ê–ñ–ù–û (—Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å OpenRouter, Kommo (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Sentry, UptimeRobot
6. **–ë—ç–∫–∞–ø—ã** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –±—ç–∫–∞–ø–æ–≤

### üü¢ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)
7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
8. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø–æ–ª–Ω—ã–π security audit

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
```bash
# 1. Frontend Health
curl https://gpt-agent-kwid.vercel.app/api/health

# 2. Worker Health
curl https://gpt-agent-platform-production.up.railway.app/health

# 3. Worker Metrics
curl https://gpt-agent-platform-production.up.railway.app/metrics

# 4. Prometheus Metrics
curl https://gpt-agent-platform-production.up.railway.app/metrics/prometheus

# 5. Frontend API endpoints
curl https://gpt-agent-kwid.vercel.app/api/auth/signin
curl https://gpt-agent-kwid.vercel.app/api/integrations/kommo/status
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ—Ö endpoints
2. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á–∏ (End-to-End)
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (OpenRouter, Kommo)
5. ‚è≥ –°–æ–∑–¥–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚úÖ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ End-to-End –ø–æ—Ç–æ–∫–æ–≤

