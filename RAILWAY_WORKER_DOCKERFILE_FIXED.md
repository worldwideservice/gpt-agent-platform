# ‚úÖ Railway Worker - Dockerfile –∏—Å–ø—Ä–∞–≤–ª–µ–Ω

## üîß –ü—Ä–æ–±–ª–µ–º–∞

–î–µ–ø–ª–æ–π –ø—Ä–æ–≤–∞–ª–∏–≤–∞–ª—Å—è –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º –≤ Dockerfile:
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è `lib/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ü–æ–ø—ã—Ç–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ production stage
- –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å —É—Å–ª–æ–≤–∏—è–º–∏

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ø—Ä–æ—â–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ base stage
- –£–±—Ä–∞–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ `lib/` (–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å `COPY . .`)
- –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è `lib/` –≤ `services/worker/lib/`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞ `cp -r` —Å fallback

### 2. –£–ø—Ä–æ—â–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production stage
- –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å —É—Å–ª–æ–≤–∏—è–º–∏
- –ü—Ä—è–º–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ base stage —á–µ—Ä–µ–∑ `COPY --from=base`
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ—Å–ª–µ base stage

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Dockerfile

**–î–æ:**
```dockerfile
COPY lib ./lib
COPY . .
RUN cp -r ../../lib ./lib || true
# –í production:
RUN mkdir -p ./services/worker/lib && \
    if [ -d "/app/services/worker/lib" ]; then ...
```

**–ü–æ—Å–ª–µ:**
```dockerfile
COPY . .
RUN cp -r ../lib ./lib || mkdir -p ./lib && cp -r ../lib/* ./lib/
# –í production:
COPY --from=base /app/services/worker/lib ./services/worker/lib
```

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ Dockerfile —É–ø—Ä–æ—â–µ–Ω –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã –≤ GitHub (commit: `d477048b`)
- ‚úÖ Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π

## ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –¥–µ–ø–ª–æ—è

Railway –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Worker.

---

**–í—Ä–µ–º—è:** 2025-01-26  
**Commit:** `d477048b`  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è

