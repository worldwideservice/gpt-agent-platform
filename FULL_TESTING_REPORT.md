# üß™ –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–î–∞—Ç–∞:** 2025-01-26  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –°–∫—Ä–∏–ø—Ç—ã - –í—Å–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–æ–≤:** 9  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

1. ‚úÖ `scripts/backup-database.sh`
2. ‚úÖ `scripts/backup-database-cron.sh`
3. ‚úÖ `scripts/cleanup-old-backups.sh`
4. ‚úÖ `scripts/check-backup-status.sh`
5. ‚úÖ `scripts/check-env-production.sh`
6. ‚úÖ `scripts/setup-backup-cron.sh`
7. ‚úÖ `scripts/backup-and-cleanup.sh`
8. ‚úÖ `scripts/test-backup-restore.sh`
9. ‚úÖ `scripts/start-monitoring-local.sh`

---

### ‚úÖ Frontend (Vercel) - –†–∞–±–æ—Ç–∞–µ—Ç

**URL:** https://gpt-agent-kwid.vercel.app

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ endpoints:**

1. ‚úÖ **Health Check** (`/api/health`)
   - HTTP Status: 200
   - Database: ‚úÖ OK
   - Redis: ‚ö†Ô∏è Warning (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º)
   - OpenRouter: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

2. ‚úÖ **Ready Check** (`/api/health/ready`)
   - HTTP Status: 200

3. ‚úÖ **Main Page** (`/`)
   - –î–æ—Å—Ç—É–ø–Ω–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### ‚úÖ Worker (Railway) - –†–∞–±–æ—Ç–∞–µ—Ç

**URL:** https://gpt-agent-platform-production.up.railway.app

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ endpoints:**

1. ‚úÖ **Health Check** (`/health`)
   - HTTP Status: 200
   - Status: "ok"
   - Redis: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ PING
   - Uptime: –†–∞–±–æ—Ç–∞–µ—Ç (–±–æ–ª–µ–µ 9000 —Å–µ–∫—É–Ω–¥)
   - Concurrency: –ù–∞—Å—Ç—Ä–æ–µ–Ω

2. ‚ö†Ô∏è **Metrics (JSON)** (`/metrics`)
   - HTTP Status: 404 (Not Found)
   - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Endpoint –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω, –≤–æ–∑–º–æ–∂–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Worker –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. ‚ö†Ô∏è **Prometheus Metrics** (`/metrics/prometheus`)
   - HTTP Status: 404 (Not Found)
   - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Endpoint –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω, –≤–æ–∑–º–æ–∂–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Worker –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è Worker —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ endpoints –º–µ—Ç—Ä–∏–∫ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Worker Health Server:

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `handlePrometheusMetrics`
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–∞ `getPrometheusMetrics()`

**–§–∞–π–ª:** `services/worker/src/health.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω try/catch –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –£–±—Ä–∞–Ω–∞ async –∏–∑ `handlePrometheusMetrics` (—Ñ—É–Ω–∫—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è)

---

## üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è

### 1. ‚úÖ `scripts/deploy-worker-railway.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Railway CLI
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –°–±–æ—Ä–∫–∞ Worker
- –î–µ–ø–ª–æ–π –Ω–∞ Railway

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/deploy-worker-railway.sh
```

### 2. ‚úÖ `scripts/deploy-frontend-vercel.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Vercel CLI
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
- –î–µ–ø–ª–æ–π –Ω–∞ Vercel (production –∏–ª–∏ preview)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/deploy-frontend-vercel.sh
```

### 3. ‚úÖ `scripts/verify-deployments.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö endpoints Frontend
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö endpoints Worker
- –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/verify-deployments.sh
```

### 4. ‚úÖ `scripts/test-all-services.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/test-all-services.sh
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é

### Worker –Ω–∞ Railway

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Railway Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://railway.app
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ —Å–µ—Ä–≤–∏—Å Worker
3. –ù–∞–∂–º–∏—Ç–µ "Deploy" –∏–ª–∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–∏ push

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway CLI**
```bash
cd services/worker
railway up
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç**
```bash
./scripts/deploy-worker-railway.sh
```

### Frontend –Ω–∞ Vercel

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Vercel Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://vercel.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –î–µ–ø–ª–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ push –≤ main branch

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Vercel CLI**
```bash
vercel --prod
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç**
```bash
./scripts/deploy-frontend-vercel.sh
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Worker Metrics Endpoints (404)

**–ü—Ä–æ–±–ª–µ–º–∞:** `/metrics` –∏ `/metrics/prometheus` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404

**–ü—Ä–∏—á–∏–Ω–∞:** –í–æ–∑–º–æ–∂–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Worker –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Worker –≤ Railway Dashboard
2. –ò–ª–∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–∏ push –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
```bash
curl https://gpt-agent-platform-production.up.railway.app/metrics
curl https://gpt-agent-platform-production.up.railway.app/metrics/prometheus
```

### 2. Frontend Redis Warning

**–ü—Ä–æ–±–ª–µ–º–∞:** Frontend Health Check –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç warning –¥–ª—è Redis

**–ü—Ä–∏—á–∏–Ω–∞:** Redis –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Frontend

**–†–µ—à–µ–Ω–∏–µ:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –µ—Å–ª–∏ Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Worker

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

- ‚úÖ **–°–∫—Ä–∏–ø—Ç—ã:** 9/9 –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (100%)
- ‚úÖ **Frontend:** 3/3 endpoints —Ä–∞–±–æ—Ç–∞—é—Ç (100%)
- ‚ö†Ô∏è **Worker:** 1/3 endpoints —Ä–∞–±–æ—Ç–∞—é—Ç (Health Check —Ä–∞–±–æ—Ç–∞–µ—Ç, Metrics —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

- ‚úÖ **–î–µ–ø–ª–æ–π Worker:** `scripts/deploy-worker-railway.sh`
- ‚úÖ **–î–µ–ø–ª–æ–π Frontend:** `scripts/deploy-frontend-vercel.sh`
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ–µ–≤:** `scripts/verify-deployments.sh`
- ‚úÖ **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** `scripts/test-all-services.sh`

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Worker –Ω–∞ Railway** –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ endpoints –º–µ—Ç—Ä–∏–∫
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:**
   ```bash
   ./scripts/verify-deployments.sh
   ```
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã:**
   ```bash
   ./scripts/setup-backup-cron.sh
   ```
4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):**
   ```bash
   ./scripts/start-monitoring-local.sh
   ```

---

## ‚úÖ –ò—Ç–æ–≥

**–ü—Ä–æ–µ–∫—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ production:**

- ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Worker —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –º–µ—Ç—Ä–∏–∫)
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω—ã

**–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ Worker –≤—Å–µ endpoints –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-26

