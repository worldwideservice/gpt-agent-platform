# Детальный отчет по странице "Dashboard (Инфопанель)"

## URL
`https://aai.widgets.wearekwid.com/manage/1000373-worldwideservices`

## Title (Заголовок страницы)
"Инфопанель - GPT Агент"

---

## Содержание отчета

1. [Общая структура страницы](#общая-структура-страницы)
2. [Основной контент](#основной-контент-main-content-area)
3. [Блок карточек статистики](#блок-карточек-статистики-statistics-cards)
4. [Блок графиков](#блок-графиков-charts-section)
5. [Панель уведомлений](#панель-уведомлений-notifications-panel)
6. [Визуальные элементы и стилизация](#визуальные-элементы-и-стилизация)
7. [Интерактивные элементы](#интерактивные-элементы)
8. [Данные для воссоздания](#данные-для-воссоздания)
9. [Layout и Spacing](#layout-и-spacing)
10. [Компонентная карта страницы](#компонентная-карта-страницы)
11. [Визуальное разделение секций](#визуальное-разделение-секций)
12. [Цветовая палитра](#цветовая-палитра)
13. [Типографика](#типографика)
14. [Иконки и их расположение](#иконки-и-их-расположение)
15. [Grid система и Layout](#grid-система-и-layout)
16. [Анимации и переходы](#анимации-и-переходы)
17. [Пустые состояния и Edge Cases](#пустые-состояния-и-edge-cases)
18. [Список всех компонентов для реализации](#список-всех-компонентов-для-реализации)
19. [API спецификации](#api-спецификации-детальные)
20. [Детальные состояния загрузки](#детальные-состояния-загрузки)
21. [Responsive Design (точные breakpoints)](#responsive-design-точные-breakpoints)
22. [Z-index слои](#z-index-слои)
23. [Focus states (детальные)](#focus-states-детальные)
24. [Hover/Active/Pressed states](#hoveractivepressed-states)
25. [Тени и эффекты (точные значения)](#тени-и-эффекты-точные-значения)
26. [Скругления (точные значения)](#скругления-точные-значения)
27. [Шрифты](#шрифты)
28. [Иконки (детальные требования)](#иконки-детальные-требования)
29. [Бизнес-логика](#бизнес-логика)
30. [Обработка ошибок (детальная)](#обработка-ошибок-детальная)
31. [Производительность](#производительность)
32. [Безопасность](#безопасность)
33. [Тестирование](#тестирование)
34. [Примеры кода](#примеры-кода)
35. [Логирование и мониторинг](#логирование-и-мониторинг)
36. [Доступность (расширенная)](#доступность-расширенная)
37. [Интернационализация (i18n)](#интернационализация-i18n)
38. [Деплой и окружения](#деплой-и-окружения)
39. [Версионирование API](#версионирование-api)
40. [Документация для пользователей](#документация-для-пользователей)

---

## Общая структура страницы

### Верхняя панель (Header)
**Примечание:** Полная детализация Header находится в отдельном файле `HEADER_DETAILED_REPORT.md`

1. **Глобальный поиск** (searchbox)
   - Тип: searchbox
   - Ref: e16
   - Placeholder: "Глобальный поиск"
   - Иконка: img (ref=e13)
   - Функция: Поиск по платформе

2. **Ссылка "30.10.2025"** (красная кнопка с предупреждением)
   - Тип: link
   - Ref: e18
   - URL: `/manage/1000373-worldwideservices/pricing`
   - Текст: "30.10.2025"
   - Иконка: img (ref=e19)
   - Функция: Уведомление об истечении лицензии, редирект на страницу тарифов
   - Визуально: Красная кнопка/ссылка с предупреждением

3. **Кнопка "Открыть уведомления"**
   - Тип: button
   - Ref: e157
   - Состояние: active (когда панель уведомлений открыта)
   - Бейдж: "1" (количество непрочитанных уведомлений, ref=e164)
   - Иконка: img (ref=e159) - колокольчик
   - Текст: "Открыть уведомления" (ref=e158)
   - Функция: Открывает диалог с уведомлениями справа
   - Поведение: При клике открывается боковая панель уведомлений

4. **Кнопка "Меню пользователя"**
   - Тип: button
   - Ref: e24
   - Аватар: img "Аватар Admin" (ref=e25)
   - Функция: Открывает меню пользователя (профиль, темы, выход)

---

## Основной контент (Main Content Area)

### Заголовок страницы
- **Текст:** "Инфопанель" (Dashboard)
- **Расположение:** Верхняя часть основного контента, слева

---

### Блок карточек статистики (Statistics Cards)

**Расположение:** Сразу под заголовком страницы
**Макет:** Grid layout, 4 карточки в ряд (на десктопе)

#### Карточка 1: "Ответы ИИ за этот месяц"
- **Ref:** e167
- **Заголовок:** "Ответы ИИ за этот месяц" (ref=e169)
- **Основное значение:** "924" (ref=e170)
  - Большой шрифт, выделенное значение
- **Дополнительная информация:**
  - Текст: "-94.1% к прошлому месяцу" (ref=e172)
  - Иконка: img (ref=e173) - стрелка вниз (отрицательная динамика)
  - Цвет: Вероятно красный/оранжевый (отрицательное изменение)
- **Функция:** Отображает количество ответов ИИ за текущий месяц с процентом изменения относительно прошлого месяца
- **Визуальное оформление:**
  - Карточка с фоном
  - Заголовок сверху
  - Большое значение по центру
  - Дополнительная информация снизу с иконкой

#### Карточка 2: "Ответы ИИ за последние 7 дней"
- **Ref:** e178
- **Заголовок:** "Ответы ИИ за последние 7 дней" (ref=e180)
- **Основное значение:** "0" (ref=e181)
- **Дополнительная информация:**
  - Текст: "Последние 7 дней" (ref=e183)
  - Иконка: img (ref=e184) - календарь
- **Функция:** Отображает количество ответов ИИ за последние 7 дней
- **Визуальное оформление:**
  - Аналогично карточке 1
  - Иконка календаря для обозначения временного периода

#### Карточка 3: "Ответы ИИ сегодня"
- **Ref:** e190
- **Заголовок:** "Ответы ИИ сегодня" (ref=e192)
- **Основное значение:** "0" (ref=e193)
- **Дополнительная информация:** Отсутствует
- **Функция:** Отображает количество ответов ИИ за сегодняшний день
- **Визуальное оформление:**
  - Аналогично карточке 1
  - Без дополнительной информации снизу

#### Карточка 4: "Агенты"
- **Ref:** e197
- **Заголовок:** "Агенты" (ref=e199)
- **Основное значение:** "2" (ref=e200)
- **Дополнительная информация:**
  - Текст: "Всего агентов" (ref=e202)
  - Иконка: img (ref=e203) - иконка агента/робота
- **Функция:** Отображает общее количество агентов в системе
- **Визуальное оформление:**
  - Аналогично карточке 1
  - Иконка агента для визуального обозначения

---

### Блок графиков (Charts Section)

**Расположение:** Под блоком карточек статистики
**Макет:** Два графика, расположены друг под другом или рядом (зависит от размера экрана)

#### График 1: "Ответы ИИ за этот месяц"

**Заголовок:**
- Тип: heading (level=3)
- Ref: e209
- Текст: "Ответы ИИ за этот месяц"
- Функция: Заголовок графика/диаграммы ответов ИИ за месяц

**Структура графика:**
- **Тип:** Линейный график (Line Chart)
- **Y-ось (вертикальная):**
  - Диапазон: 0 до 20,000
  - Шаг: 5,000
  - Подписи: 0, 5,000, 10,000, 15,000, 20,000
- **X-ось (горизонтальная):**
  - Период: С "июнь 2025" (June 2025) до "ноябрь 2025" (November 2025)
  - Формат: "месяц год" (например, "июнь 2025", "июль 2025", и т.д.)
  - Месяцы: июнь, июль, август, сентябрь, октябрь, ноябрь
- **Данные графика:**
  - Линия показывает стабильный рост с июня по октябрь
  - Резкое падение в ноябре
  - Пик в октябре (около 15,000-20,000)
  - Минимум в ноябре (около 0-5,000)
- **Визуальное оформление:**
  - Линия графика
  - Точки данных на линии
  - Сетка для удобства чтения
  - Подписи осей

#### График 2: "Ответы ИИ за день"

**Заголовок:**
- Тип: heading (level=3)
- Ref: e218
- Текст: "Ответы ИИ за день"
- Функция: Заголовок графика/диаграммы ответов ИИ за день

**Структура графика:**
- **Тип:** Линейный график (Line Chart)
- **Y-ось (вертикальная):**
  - Диапазон: 0 до 600
  - Шаг: 200
  - Подписи: 0, 200, 400, 600
- **X-ось (горизонтальная):**
  - Период: С "срд, окт 29" (Wed, Oct 29) до "чтв, ноя 06" (Thu, Nov 06)
  - Формат: "день недели, месяц число" (например, "срд, окт 29")
  - Дни: среда 29 октября, четверг 30 октября, пятница 31 октября, суббота 1 ноября, воскресенье 2 ноября, понедельник 3 ноября, вторник 4 ноября, среда 5 ноября, четверг 6 ноября
- **Данные графика:**
  - Линия показывает флуктуации по дням
  - Пик около "сбт, ноя 01" (Sat, Nov 01) - около 400-600
  - Снижение после пика до минимума
  - Общая тенденция к снижению к концу периода
- **Визуальное оформление:**
  - Линия графика
  - Точки данных на линии
  - Сетка для удобства чтения
  - Подписи осей

---

## Панель уведомлений (Notifications Panel)

**Тип:** Dialog/Side Panel (боковая панель справа)
**Открытие:** При клике на кнопку "Открыть уведомления" (ref=e157)
**Закрытие:** 
  - Клавиша Escape
  - Клик вне панели (вероятно)
  - Кнопка закрытия (X)

### Структура панели уведомлений:

#### Заголовок панели:
- **Текст:** "Уведомления"
- **Счетчик:** "1" (количество непрочитанных уведомлений)
- **Расположение:** Верхняя часть панели

#### Действия с уведомлениями:
- **Ссылка "Отметить как прочитанное"** (Mark as read)
  - Функция: Помечает все уведомления как прочитанные
- **Ссылка "Удалить"** (Delete)
  - Функция: Удаляет уведомления

#### Список уведомлений:

**Тип уведомления:** "Лицензия истекла: ответы ИИ отключены"

**Структура каждого уведомления:**
- **Заголовок:** "Лицензия истекла: ответы ИИ отключены"
- **Временная метка:** 
  - Формат: Относительное время (например, "15 минут назад", "48 минут назад", "1 час назад", "2 часа назад")
  - Примеры временных меток:
    - "15 минут назад"
    - "48 минут назад"
    - "1 час назад"
    - "2 часа назад"
- **Описание:** 
  - Текст: "Для "World Wide Services" ответы ИИ отключены, так как срок действия вашей лицензии истек."
  - Содержит название workspace: "World Wide Services"
- **Кнопка действия:** 
  - Текст: "Продлить лицензию" (Renew license)
  - Цвет: Зеленый
  - Функция: Переход на страницу продления лицензии
- **Кнопка закрытия:** 
  - Иконка: "X"
  - Расположение: Справа от уведомления
  - Функция: Закрывает/удаляет конкретное уведомление

**Визуальное оформление:**
- Каждое уведомление в отдельном блоке
- Временная метка серым цветом
- Кнопка действия выделена зеленым
- Кнопка закрытия справа

---

## Визуальные элементы и стилизация

### Цветовая схема:
- **Основной фон:** Светлый (белый/светло-серый)
- **Карточки статистики:** С фоном, возможно с тенью
- **Графики:** Сетка, линии, точки данных
- **Уведомления:** 
  - Предупреждения: Красный/оранжевый
  - Кнопки действий: Зеленый
- **Текст:** Темный на светлом фоне

### Типографика:
- **Заголовки:** Крупный шрифт, жирный
- **Значения в карточках:** Очень крупный шрифт
- **Дополнительная информация:** Мелкий шрифт
- **Графики:** Средний шрифт для подписей

### Отступы и расположение:
- **Карточки:** Grid layout, равномерное распределение
- **Графики:** Полная ширина контейнера
- **Панель уведомлений:** Боковая панель справа, overlay поверх контента

---

## Интерактивные элементы

### Кликабельные элементы:
1. **Карточки статистики:** Возможно кликабельны для перехода к детальной статистике
2. **Графики:** Возможно интерактивны (hover для показа значений, zoom)
3. **Кнопка уведомлений:** Открывает панель уведомлений
4. **Кнопки в уведомлениях:** 
   - "Продлить лицензию" - переход на страницу тарифов
   - "X" - закрытие уведомления
5. **Ссылки действий:** "Отметить как прочитанное", "Удалить"

---

## Данные для воссоздания

### Статистика (текущие значения):
- **Ответы ИИ за этот месяц:** 924
- **Изменение к прошлому месяцу:** -94.1%
- **Ответы ИИ за последние 7 дней:** 0
- **Ответы ИИ сегодня:** 0
- **Всего агентов:** 2

### Данные графика "Ответы ИИ за этот месяц":
- **Период:** Июнь 2025 - Ноябрь 2025
- **Диапазон значений:** 0 - 20,000
- **Тренд:** Рост с июня по октябрь, резкое падение в ноябре

### Данные графика "Ответы ИИ за день":
- **Период:** 29 октября 2025 - 6 ноября 2025
- **Диапазон значений:** 0 - 600
- **Пик:** Около 1 ноября (400-600)
- **Тренд:** Флуктуации с общим снижением

### Уведомления:
- **Тип:** "Лицензия истекла: ответы ИИ отключены"
- **Количество:** Множественные (в списке видно несколько)
- **Временные метки:** От "15 минут назад" до "2 часа назад"
- **Workspace:** "World Wide Services"

---

## Протестированные элементы

### ✅ Полностью протестировано:

1. ✅ **Карточки статистики (4 карточки):**
   - Все заголовки и значения зафиксированы
   - Дополнительная информация (проценты, иконки) зафиксирована
   - Визуальное оформление описано

2. ✅ **Графики (2 графика):**
   - Заголовки зафиксированы
   - Структура осей (X и Y) полностью описана
   - Диапазоны значений зафиксированы
   - Формат подписей осей описан
   - Тренды данных описаны

3. ✅ **Панель уведомлений:**
   - Структура панели полностью описана
   - Все элементы уведомлений зафиксированы
   - Действия с уведомлениями описаны
   - Визуальное оформление описано

4. ✅ **Header элементы:**
   - Все элементы header описаны
   - Интерактивность проверена

---

## Технические детали для реализации

### Компоненты:
1. **StatisticsCards** - компонент для карточек статистики
2. **LineChart** - компонент для линейных графиков (возможно Chart.js, Recharts, или аналогичная библиотека)
3. **NotificationsPanel** - компонент боковой панели уведомлений
4. **NotificationItem** - компонент отдельного уведомления

### API endpoints (предположительно):
- `/api/dashboard/stats` - статистика для карточек
- `/api/dashboard/monthly-chart` - данные для графика за месяц
- `/api/dashboard/daily-chart` - данные для графика за день
- `/api/notifications` - список уведомлений

### Состояния:
- Загрузка данных (loading)
- Ошибки загрузки (error)
- Успешная загрузка (success)
- Открыто/закрыто панель уведомлений

---

## Layout и Spacing

### Общая структура страницы
- **Максимальная ширина контента:** 1200px (центрирован)
- **Отступы от краев:** 24px (desktop), 16px (tablet), 12px (mobile)
- **Отступ между Header и Main Content:** 24px
- **Отступ между Sidebar и Main Content:** 24px

### Разделение секций
- **Отступ между секциями:** 32px (вертикальный)
- **Визуальное разделение секций:**
  - Каждая секция в отдельной карточке (card)
  - Фон карточки: белый (#FFFFFF)
  - Тень: `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
  - Скругление углов: `border-radius: 8px`
  - Внутренние отступы карточки: `padding: 24px`
  - Граница: `border: 1px solid #E5E7EB` (опционально)

### Отступы внутри секций
- **Отступ между заголовком секции и содержимым:** 16px
- **Отступ между карточками статистики:** 24px (горизонтальный)
- **Отступ между графиками:** 32px (вертикальный)
- **Внутренние отступы карточек статистики:** 20px

---

## Компонентная карта страницы

### Полный список компонентов на странице "Dashboard"

#### Основная страница (`/`)
1. **Breadcrumbs** - навигационная цепочка (опционально)
2. **Heading (h1)** - "Инфопанель"
3. **StatisticsCards Grid** - сетка карточек статистики (4 карточки)
   - **Card 1:** "Ответы ИИ за этот месяц"
     - Heading (h3)
     - Большое значение (number)
     - Процент изменения с иконкой
   - **Card 2:** "Ответы ИИ за последние 7 дней"
     - Heading (h3)
     - Большое значение (number)
     - Иконка календаря
   - **Card 3:** "Ответы ИИ сегодня"
     - Heading (h3)
     - Большое значение (number)
   - **Card 4:** "Агенты"
     - Heading (h3)
     - Большое значение (number)
     - Иконка агента
4. **Charts Section** - секция графиков
   - **Chart 1:** "Ответы ИИ за этот месяц"
     - Heading (h3)
     - LineChart компонент
     - Оси X и Y с подписями
   - **Chart 2:** "Ответы ИИ за день"
     - Heading (h3)
     - LineChart компонент
     - Оси X и Y с подписями
5. **NotificationsPanel** - боковая панель уведомлений (Dialog)
   - Заголовок с счетчиком
   - Действия: "Отметить как прочитанное", "Удалить"
   - Список уведомлений
   - Кнопка закрытия

---

## Визуальное разделение секций

### Структура секции
Каждая секция представляет собой отдельную карточку (card) со следующими характеристиками:

#### Визуальные параметры карточки статистики
- **Фон:** #FFFFFF (белый)
- **Тень:** 
  - `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
  - `box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05)` (при hover)
- **Граница:** 
  - `border: 1px solid #E5E7EB` (светло-серый)
  - `border-radius: 8px`
- **Внутренние отступы:** 
  - `padding: 20px` (desktop)
  - `padding: 16px` (tablet)
  - `padding: 12px` (mobile)
- **Отступ снизу:** `margin-bottom: 0` (в grid)

#### Визуальные параметры графика
- **Фон:** #FFFFFF (белый)
- **Тень:** `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
- **Граница:** `border: 1px solid #E5E7EB`
- **Скругление:** `border-radius: 8px`
- **Внутренние отступы:** `padding: 24px`
- **Отступ снизу:** `margin-bottom: 32px`

---

## Цветовая палитра

### Основные цвета
- **Фон страницы:** #F9FAFB (светло-серый)
- **Фон карточек:** #FFFFFF (белый)
- **Фон overlay:** rgba(0, 0, 0, 0.5) (50% прозрачности черного)

### Цвета текста
- **Основной текст:** #111827 (темно-серый, почти черный)
- **Вторичный текст:** #6B7280 (серый)
- **Текст описаний:** #9CA3AF (светло-серый)
- **Текст ошибок:** #DC2626 (красный)
- **Текст успеха:** #10B981 (зеленый)
- **Текст отрицательного изменения:** #DC2626 (красный)
- **Текст положительного изменения:** #10B981 (зеленый)

### Цвета карточек статистики
- **Фон карточки:** #FFFFFF (белый)
- **Заголовок:** #6B7280 (серый)
- **Основное значение:** #111827 (темно-серый)
- **Процент изменения (отрицательный):** #DC2626 (красный)
- **Процент изменения (положительный):** #10B981 (зеленый)

### Цвета графиков
- **Фон графика:** #FFFFFF (белый)
- **Линия графика:** #3B82F6 (синий)
- **Сетка:** #E5E7EB (светло-серый)
- **Подписи осей:** #6B7280 (серый)
- **Точки данных:** #3B82F6 (синий)

### Цвета панели уведомлений
- **Фон панели:** #FFFFFF (белый)
- **Фон overlay:** rgba(0, 0, 0, 0.5)
- **Фон уведомления:** #F9FAFB (светло-серый)
- **Кнопка действия:** #10B981 (зеленый)
- **Временная метка:** #9CA3AF (светло-серый)

---

## Типографика

### Шрифт
- **Семейство:** System font stack или кастомный шрифт
- **Базовый размер:** 16px
- **Line height:** 1.5 (24px)

### Заголовки
- **H1 (Заголовок страницы):**
  - Размер: 32px
  - Вес: 700 (bold)
  - Line height: 1.2
  - Цвет: #111827
  - Margin-bottom: 24px

- **H3 (Заголовок карточки/графика):**
  - Размер: 18px
  - Вес: 600 (semi-bold)
  - Line height: 1.3
  - Цвет: #6B7280
  - Margin-bottom: 16px

### Текст
- **Основное значение в карточке:**
  - Размер: 36px
  - Вес: 700 (bold)
  - Line height: 1.2
  - Цвет: #111827

- **Процент изменения:**
  - Размер: 14px
  - Вес: 500 (medium)
  - Line height: 1.4
  - Цвет: #DC2626 (отрицательный) или #10B981 (положительный)

- **Вторичный текст:**
  - Размер: 14px
  - Вес: 400 (regular)
  - Line height: 1.5
  - Цвет: #6B7280

---

## Иконки и их расположение

### Размеры иконок
- **Иконки в карточках:** 20px × 20px
- **Иконки в графиках:** 16px × 16px
- **Иконки в уведомлениях:** 16px × 16px
- **Иконка колокольчика:** 20px × 20px

### Иконки по элементам
- **Иконка календаря:** Calendar icon (20px)
- **Иконка агента:** User/Robot icon (20px)
- **Иконка стрелки вниз (отрицательное изменение):** ArrowDown icon (16px)
- **Иконка стрелки вверх (положительное изменение):** ArrowUp icon (16px)
- **Иконка колокольчика:** Bell icon (20px)
- **Иконка закрытия уведомления:** X icon (16px)

---

## Grid система и Layout

### Общая структура
- **Container:** max-width: 1200px, margin: 0 auto
- **Grid columns:** 12 колонок (desktop)
- **Gap между колонками:** 24px

### Расположение элементов

#### Карточки статистики
- **Grid layout:** 4 колонки на desktop (grid-template-columns: repeat(4, 1fr))
- **Gap:** 24px между карточками
- **Tablet:** 2 колонки (grid-template-columns: repeat(2, 1fr))
- **Mobile:** 1 колонка (grid-template-columns: 1fr)

#### Графики
- **Расположение:** Вертикальный стек (flex-direction: column)
- **Gap:** 32px между графиками
- **Ширина:** 100%

---

## Анимации и переходы

### Длительности
- **Быстрые переходы:** 150ms (hover эффекты)
- **Стандартные переходы:** 200ms (открытие/закрытие панели)
- **Медленные переходы:** 300ms (анимация графиков)

### Easing функции
- **Стандартный:** ease-in-out
- **Smooth:** cubic-bezier(0.4, 0, 0.2, 1)

### Анимации компонентов

#### Карточки статистики
- **Hover:**
  - transform: translateY(-2px)
  - box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05)
  - transition: 150ms

#### Графики
- **Загрузка данных:**
  - Анимация появления линии графика
  - Длительность: 800ms
  - Easing: ease-out

#### Панель уведомлений
- **Открытие:**
  - transform: translateX(100%) → translateX(0)
  - opacity: 0 → 1
  - transition: 300ms
- **Overlay:**
  - opacity: 0 → 0.5
  - transition: 300ms

---

## Пустые состояния и Edge Cases

### Пустое состояние графиков
- **Когда отображается:** Нет данных за выбранный период
- **Структура:**
  - Иконка (иллюстрация)
  - Заголовок: "Нет данных"
  - Описание: "За выбранный период нет данных для отображения"

### Edge Cases

#### Очень большие числа
- **Обработка:** Форматирование с разделителями тысяч (1,574)
- **Сокращение:** Для очень больших чисел (например, 1.5K, 1.5M)

#### Отрицательные проценты
- **Отображение:** Красный цвет, иконка стрелки вниз
- **Формат:** "-94.1% к прошлому месяцу"

#### Нулевые значения
- **Отображение:** "0" без дополнительной информации

---

## Список всех компонентов для реализации

### Базовые компоненты
1. **Heading** - заголовки (h1, h3)
2. **Card** - карточки статистики
3. **LineChart** - линейные графики
4. **Dialog/Panel** - боковая панель уведомлений
5. **NotificationItem** - элемент уведомления
6. **Button** - кнопки
7. **Badge** - бейдж для счетчиков
8. **Icon** - иконки
9. **Empty State** - пустое состояние
10. **Grid** - сетка для карточек

### Специфичные компоненты
1. **StatisticsCard** - карточка статистики с значением и процентом
2. **MonthlyChart** - график за месяц
3. **DailyChart** - график за день
4. **NotificationsPanel** - боковая панель уведомлений
5. **ChartAxis** - оси графика с подписями

---

## API спецификации (детальные)

### Базовый URL
- **Production:** `https://aai.widgets.wearekwid.com/api`
- **Development:** `http://localhost:3000/api`

### Аутентификация
- **Тип:** Bearer Token (JWT)
- **Header:** `Authorization: Bearer {token}`
- **Refresh Token:** Через `/api/auth/refresh`
- **Expiration:** Access token - 15 минут, Refresh token - 7 дней

### Формат запросов/ответов
- **Content-Type:** `application/json`
- **Accept:** `application/json`
- **Кодировка:** UTF-8

### Endpoints для страницы "Dashboard"

#### 1. Получение статистики
```
GET /api/dashboard/stats

Response 200:
{
  "data": {
    "monthlyResponses": {
      "current": number,
      "previous": number,
      "change": number (процент изменения)
    },
    "weeklyResponses": {
      "count": number
    },
    "todayResponses": {
      "count": number
    },
    "agents": {
      "total": number
    }
  }
}
```

#### 2. Получение данных графика за месяц
```
GET /api/dashboard/monthly-chart
Query Parameters:
  - startDate: ISO 8601 (optional)
  - endDate: ISO 8601 (optional)

Response 200:
{
  "data": [
    {
      "date": "ISO 8601",
      "value": number
    }
  ]
}
```

#### 3. Получение данных графика за день
```
GET /api/dashboard/daily-chart
Query Parameters:
  - days: number (default: 7)
  - startDate: ISO 8601 (optional)

Response 200:
{
  "data": [
    {
      "date": "ISO 8601",
      "value": number
    }
  ]
}
```

#### 4. Получение уведомлений
```
GET /api/notifications
Query Parameters:
  - page: number (default: 1)
  - limit: number (default: 20)
  - unreadOnly: boolean (default: false)

Response 200:
{
  "data": [
    {
      "id": string,
      "title": "string",
      "message": "string",
      "type": "string",
      "read": boolean,
      "createdAt": "ISO 8601",
      "actionUrl": "string" (optional),
      "actionLabel": "string" (optional)
    }
  ],
  "pagination": {
    "page": number,
    "limit": number,
    "total": number,
    "unreadCount": number
  }
}
```

#### 5. Отметить уведомления как прочитанные
```
POST /api/notifications/mark-read
Body:
{
  "ids": string[] (optional, если пусто - все уведомления)
}

Response 200:
{
  "success": boolean,
  "markedCount": number
}
```

#### 6. Удалить уведомления
```
DELETE /api/notifications
Body:
{
  "ids": string[] (optional, если пусто - все уведомления)
}

Response 200:
{
  "success": boolean,
  "deletedCount": number
}
```

### Rate Limiting
- **Стандартные запросы:** 100 запросов в минуту
- **Графики:** 60 запросов в минуту

### Коды ошибок
- **200:** Успешный запрос
- **401:** Не авторизован
- **403:** Нет доступа
- **429:** Превышен лимит запросов
- **500:** Внутренняя ошибка сервера

---

## Детальные состояния загрузки

### Skeleton Loaders

#### Карточки статистики
- **Структура:** 4 карточки с placeholder'ами
- **Анимация:** Пульсация (shimmer effect)
- **Высота:** 120px
- **Ширина:** Пропорциональная grid колонкам

#### Графики
- **Структура:** Placeholder прямоугольник с сеткой
- **Высота:** 400px
- **Анимация:** Пульсация (shimmer effect)

### Spinner'ы
- **Размер:** 24px × 24px
- **Цвет:** #3B82F6 (синий)
- **Расположение:** Центр контейнера
- **Анимация:** Вращение 360° за 1 секунду

### Оптимистичные обновления
- **Уведомления:** Обновление счетчика сразу при действиях
- **Статистика:** Кэширование на 1 минуту

---

## Responsive Design (точные breakpoints)

### Breakpoints
- **Mobile:** ≤ 767px
- **Tablet:** 768px - 1023px
- **Desktop:** ≥ 1024px
- **Large Desktop:** ≥ 1440px

### Адаптация компонентов

#### Карточки статистики
- **Desktop:** 4 колонки в ряд
- **Tablet:** 2 колонки в ряд
- **Mobile:** 1 колонка, полная ширина

#### Графики
- **Desktop:** Полная ширина, высота 400px
- **Tablet:** Полная ширина, высота 350px
- **Mobile:** Полная ширина, высота 300px, горизонтальный скролл при необходимости

#### Панель уведомлений
- **Desktop:** Ширина 400px, справа
- **Tablet:** Ширина 90%, справа
- **Mobile:** Полная ширина, снизу вверх

---

## Z-index слои

### Порядок наложения
1. **Base content:** z-index: 1
2. **Sticky elements:** z-index: 10
3. **Cards:** z-index: 1
4. **Charts:** z-index: 1
5. **Notifications Panel:** z-index: 1000
6. **Notifications Overlay:** z-index: 999
7. **Tooltips:** z-index: 3000

### Конкретные значения
- **Header:** z-index: 100
- **Sidebar:** z-index: 50
- **Панель уведомлений:** z-index: 1000
- **Overlay панели уведомлений:** z-index: 999

---

## Focus states (детальные)

### Визуальные индикаторы
- **Цвет:** #3B82F6 (синий)
- **Толщина:** 2px
- **Стиль:** solid
- **Offset:** 2px (outline-offset)

### Порядок табуляции
1. Кнопка "Открыть уведомления"
2. Карточки статистики (по порядку)
3. Графики (по порядку)
4. Элементы панели уведомлений

### Keyboard navigation
- **Tab:** Следующий элемент
- **Shift+Tab:** Предыдущий элемент
- **Enter/Space:** Активация элемента
- **Escape:** Закрытие панели уведомлений
- **Arrow keys:** Навигация в графиках (опционально)

---

## Hover/Active/Pressed states

### Карточки статистики
- **Hover:**
  - transform: translateY(-2px)
  - box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05)
  - transition: 150ms
- **Active:**
  - transform: translateY(0)
  - transition: 100ms

### Кнопки
- **Hover:**
  - background-color: #F3F4F6
  - transition: 150ms
- **Active:**
  - transform: scale(0.98)
  - transition: 100ms

### Графики
- **Hover на точку данных:**
  - Увеличение точки
  - Показ tooltip с значением
  - transition: 150ms

---

## Тени и эффекты (точные значения)

### Тени карточек
- **Стандартная:** `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
- **Hover:** `box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05)`

### Тени графиков
- **Стандартная:** `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`

### Тени панели уведомлений
- **Overlay:** `box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15)`

---

## Скругления (точные значения)

### Компоненты
- **Карточки:** border-radius: 8px
- **Графики:** border-radius: 8px
- **Кнопки:** border-radius: 6px
- **Панель уведомлений:** border-radius: 8px (слева сверху и снизу)
- **Элементы уведомлений:** border-radius: 6px

---

## Шрифты

### Семейство шрифтов
- **Основной:** System font stack
  - `-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif`
- **Моноширинный:** `"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace`

### Размеры
- **Base:** 16px
- **Small:** 14px
- **XSmall:** 12px
- **Large:** 18px
- **XLarge:** 24px
- **XXLarge:** 32px
- **XXXLarge:** 36px (основное значение в карточке)

### Веса
- **Regular:** 400
- **Medium:** 500
- **Semi-bold:** 600
- **Bold:** 700

---

## Иконки (детальные требования)

### Библиотека
- **Рекомендуется:** Lucide React, Heroicons, или аналогичная
- **Формат:** SVG
- **Размеры:** 12px, 16px, 20px, 24px

### Иконки для Dashboard
- **Календарь:** Calendar
- **Агент:** User, Bot, или Users
- **Стрелка вниз:** ArrowDown, TrendingDown
- **Стрелка вверх:** ArrowUp, TrendingUp
- **Колокольчик:** Bell
- **Закрыть:** X

---

## Бизнес-логика

### Расчет статистики
- **Ответы ИИ за месяц:** Сумма всех ответов за текущий месяц
- **Процент изменения:** ((текущий - предыдущий) / предыдущий) * 100
- **Ответы за 7 дней:** Сумма за последние 7 дней
- **Ответы сегодня:** Сумма за сегодняшний день
- **Всего агентов:** Количество активных агентов

### Обновление данных
- **Автоматическое обновление:** Каждые 5 минут
- **Ручное обновление:** Кнопка обновления (опционально)

### Кэширование
- **Статистика:** Кэшируется на 1 минуту
- **Графики:** Кэшируются на 5 минут
- **Уведомления:** Обновляются в реальном времени

---

## Обработка ошибок (детальная)

### Типы ошибок

#### API ошибки
- **400 Bad Request:** Toast уведомление "Ошибка запроса"
- **401 Unauthorized:** Редирект на страницу входа
- **403 Forbidden:** Toast уведомление "Нет доступа"
- **429 Too Many Requests:** Toast уведомление "Слишком много запросов"
- **500 Internal Server Error:** Toast уведомление "Ошибка сервера"

### Toast уведомления
- **Успех:** Зеленый, иконка checkmark
- **Ошибка:** Красный, иконка X
- **Предупреждение:** Оранжевый, иконка warning
- **Информация:** Синий, иконка info

### Retry логика
- **Автоматический retry:** Для сетевых ошибок (3 попытки)
- **Экспоненциальная задержка:** 1s, 2s, 4s

---

## Производительность

### Оптимизации

#### Ленивая загрузка
- **Графики:** Загружаются после карточек статистики
- **Уведомления:** Загружаются только при открытии панели

#### Кэширование
- **Статистика:** Кэшируется на 1 минуту
- **Графики:** Кэшируются на 5 минут

#### Debounce
- **Обновление данных:** 500ms debounce

#### Виртуализация
- **Список уведомлений:** Виртуализация при большом количестве (>50)

---

## Безопасность

### Аутентификация
- **JWT токены:** Хранятся в httpOnly cookies
- **Refresh токены:** Отдельные токены с большим сроком действия

### Авторизация
- **RBAC:** Role-Based Access Control
- **Проверка прав:** На уровне API и UI

### Валидация
- **На сервере:** Обязательная для безопасности
- **Sanitization:** Очистка пользовательского ввода

---

## Тестирование

### Unit тесты
- **Компоненты:** React Testing Library
- **Утилиты:** Jest
- **Покрытие:** Минимум 80%

### Integration тесты
- **Карточки статистики:** Тестирование отображения данных
- **Графики:** Тестирование отображения данных
- **Уведомления:** Тестирование открытия/закрытия панели

### E2E тесты
- **Playwright или Cypress:** Полные сценарии использования
- **Сценарии:**
  - Загрузка Dashboard
  - Открытие панели уведомлений
  - Взаимодействие с уведомлениями
  - Обновление данных

---

## Примеры кода

### Компонент карточки статистики
```typescript
import { Card } from '@/components/ui/card';

interface StatisticsCardProps {
  title: string;
  value: number | string;
  change?: {
    value: number;
    isPositive: boolean;
  };
  icon?: React.ReactNode;
}

export function StatisticsCard({ title, value, change, icon }: StatisticsCardProps) {
  return (
    <Card className="p-5">
      <div className="flex items-center justify-between mb-4">
        <h3 className="text-sm font-medium text-gray-600">{title}</h3>
        {icon && <div className="w-5 h-5 text-gray-400">{icon}</div>}
      </div>
      <div className="text-3xl font-bold text-gray-900 mb-2">{value}</div>
      {change && (
        <div className={`flex items-center text-sm ${
          change.isPositive ? 'text-green-600' : 'text-red-600'
        }`}>
          <span>{change.isPositive ? '+' : ''}{change.value}%</span>
          {change.isPositive ? <ArrowUpIcon /> : <ArrowDownIcon />}
        </div>
      )}
    </Card>
  );
}
```

### Компонент графика
```typescript
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';

interface ChartData {
  date: string;
  value: number;
}

interface DashboardChartProps {
  title: string;
  data: ChartData[];
  yAxisRange?: { min: number; max: number; step: number };
}

export function DashboardChart({ title, data, yAxisRange }: DashboardChartProps) {
  return (
    <Card className="p-6">
      <h3 className="text-lg font-semibold mb-4">{title}</h3>
      <ResponsiveContainer width="100%" height={400}>
        <LineChart data={data}>
          <CartesianGrid strokeDasharray="3 3" stroke="#E5E7EB" />
          <XAxis 
            dataKey="date" 
            stroke="#6B7280"
            tick={{ fill: '#6B7280' }}
          />
          <YAxis 
            domain={yAxisRange ? [yAxisRange.min, yAxisRange.max] : ['auto', 'auto']}
            tickCount={yAxisRange ? (yAxisRange.max - yAxisRange.min) / yAxisRange.step : undefined}
            stroke="#6B7280"
            tick={{ fill: '#6B7280' }}
          />
          <Tooltip />
          <Line 
            type="monotone" 
            dataKey="value" 
            stroke="#3B82F6" 
            strokeWidth={2}
            dot={{ fill: '#3B82F6', r: 4 }}
          />
        </LineChart>
      </ResponsiveContainer>
    </Card>
  );
}
```

---

## Логирование и мониторинг

### Что логировать
- **Загрузка Dashboard:** Время загрузки, количество запросов
- **Ошибки загрузки:** Полная информация об ошибке, stack trace
- **Действия пользователя:** Открытие уведомлений, клики по карточкам

### Уровни логов
- **Error:** Критические ошибки
- **Warn:** Предупреждения
- **Info:** Информационные сообщения
- **Debug:** Детальная информация (только в development)

---

## Доступность (расширенная)

### ARIA атрибуты
- **aria-label:** Для всех интерактивных элементов без видимого текста
- **aria-live:** Для динамического контента (статистика, уведомления)
- **aria-expanded:** Для панели уведомлений
- **aria-describedby:** Для карточек с дополнительной информацией

### Keyboard navigation
- **Tab:** Навигация по элементам
- **Enter/Space:** Активация
- **Escape:** Закрытие панели уведомлений

### Screen readers
- **Семантический HTML:** Правильное использование тегов
- **Alt тексты:** Для всех изображений
- **Скрытые тексты:** Для визуальных элементов без текста

---

## Интернационализация (i18n)

### Поддерживаемые языки
- **Основной:** Русский (ru)
- **Дополнительные:** Английский (en) - опционально

### Форматирование
- **Даты:** Формат зависит от локали
- **Числа:** Формат зависит от локали (разделители тысяч)
- **Проценты:** Формат зависит от локали

### Переводы
- **Все тексты:** В файлах переводов
- **Динамические тексты:** Плейсхолдеры для переменных

---

## Деплой и окружения

### Окружения
- **Development:** `http://localhost:3000`
- **Staging:** `https://staging.aai.widgets.wearekwid.com`
- **Production:** `https://aai.widgets.wearekwid.com`

### CI/CD
- **Автоматический деплой:** При merge в main
- **Тесты:** Запускаются перед деплоем
- **Rollback:** Автоматический при ошибках

---

## Версионирование API

### Формат версий
- **Текущая версия:** v1
- **Формат:** `/api/v1/dashboard/stats`

### Изменения
- **Breaking changes:** Новая major версия
- **Новые endpoints:** Без изменения версии
- **Deprecation:** За 3 месяца до удаления

---

## Документация для пользователей

### Tooltips и подсказки
- **Карточка "Ответы ИИ за этот месяц":** "Количество ответов, сгенерированных агентами за текущий месяц"
- **Процент изменения:** "Изменение относительно прошлого месяца"
- **График:** "Наведите курсор на точку для просмотра детальной информации"

### Help тексты
- **Под графиками:** "Графики обновляются автоматически каждые 5 минут"

---

**Дата создания отчета:** 2025-11-11
**Дата последнего обновления:** 2025-01-26
**Версия:** 4.0
**Статус:** Полностью протестировано и детализировано для репликации
