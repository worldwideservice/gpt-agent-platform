# Детальный отчет по странице "Статьи"

## URL
`https://aai.widgets.wearekwid.com/manage/1000373-worldwideservices/knowledge-items`

## Title (Заголовок страницы)
"Статьи - GPT Агент"

---

## Содержание отчета

1. [Общая структура страницы](#общая-структура-страницы)
2. [Основной контент страницы](#основной-контент-страницы)
3. [Панель инструментов (Toolbar)](#панель-инструментов-toolbar)
4. [Блок "Активные фильтры"](#блок-активные-фильтры)
5. [Область контента](#область-контента)
6. [Страница создания/редактирования статьи](#страница-созданияредактирования-статьи)
7. [Технические детали для реализации](#технические-детали-для-реализации)
8. [Визуальные детали](#визуальные-детали)
9. [Резюме протестированных элементов](#резюме-протестированных-элементов)
10. [Layout и Spacing](#layout-и-spacing)
11. [Компонентная карта страницы](#компонентная-карта-страницы)
12. [Визуальное разделение секций](#визуальное-разделение-секций)
13. [Цветовая палитра](#цветовая-палитра)
14. [Типографика](#типографика)
15. [Иконки и их расположение](#иконки-и-их-расположение)
16. [Grid система и Layout](#grid-система-и-layout)
17. [Анимации и переходы](#анимации-и-переходы)
18. [Пустые состояния и Edge Cases](#пустые-состояния-и-edge-cases)
19. [Список всех компонентов для реализации](#список-всех-компонентов-для-реализации)
20. [API спецификации](#api-спецификации-детальные)
21. [Детальные состояния загрузки](#детальные-состояния-загрузки)
22. [Responsive Design (точные breakpoints)](#responsive-design-точные-breakpoints)
23. [Z-index слои](#z-index-слои)
24. [Focus states (детальные)](#focus-states-детальные)
25. [Hover/Active/Pressed states](#hoveractivepressed-states)
26. [Тени и эффекты (точные значения)](#тени-и-эффекты-точные-значения)
27. [Скругления (точные значения)](#скругления-точные-значения)
28. [Шрифты](#шрифты)
29. [Иконки (детальные требования)](#иконки-детальные-требования)
30. [Бизнес-логика](#бизнес-логика)
31. [Обработка ошибок (детальная)](#обработка-ошибок-детальная)
32. [Производительность](#производительность)
33. [Безопасность](#безопасность)
34. [Тестирование](#тестирование)
35. [Примеры кода](#примеры-кода)
36. [Логирование и мониторинг](#логирование-и-мониторинг)
37. [Доступность (расширенная)](#доступность-расширенная)
38. [Интернационализация (i18n)](#интернационализация-i18n)
39. [Деплой и окружения](#деплой-и-окружения)
40. [Версионирование API](#версионирование-api)
41. [Документация для пользователей](#документация-для-пользователей)

---

## Общая структура страницы

### Верхняя панель (Header)
**Примечание:** Полная детализация Header находится в отдельном файле `HEADER_DETAILED_REPORT.md`

1. **Глобальный поиск** (searchbox)
   - Тип: searchbox
   - Ref: e16
   - Placeholder: "Глобальный поиск"
   - Иконка: img (ref=e13)
   - Функция: Поиск по платформе

2. **Ссылка "30.10.2025"** (красная кнопка с предупреждением)
   - Тип: link
   - Ref: e18
   - URL: `/manage/1000373-worldwideservices/pricing`
   - Текст: "30.10.2025"
   - Иконка: img (ref=e19)
   - Функция: Уведомление об истечении лицензии, редирект на страницу тарифов

3. **Кнопка "Открыть уведомления"**
   - Тип: button
   - Ref: e24
   - Бейдж: "2" (количество непрочитанных уведомлений)
   - Функция: Открывает панель уведомлений

4. **Кнопка "Меню пользователя"**
   - Тип: button
   - Ref: e34
   - Содержимое: Аватар пользователя (img, ref=e35)
   - Функция: Открывает меню пользователя

---

## Основной контент страницы

### 1. Навигация страницы (Breadcrumbs/Tabs)

#### Структура:
- **Контейнер:** navigation (ref=e41)
- **Список:** list (ref=e42)

#### Элементы:

##### 1.1. Ссылка "Статьи"
- **Тип:** link
- **Ref:** e44
- **URL:** `/manage/1000373-worldwideservices/knowledge-items`
- **Текст:** "Статьи"
- **Состояние:** active (текущая страница)
- **Функция:** Переход на страницу списка статей

##### 1.2. Ссылка "Список"
- **Тип:** link (listitem, ref=e45)
- **Ref:** e45
- **Содержимое:**
  - Иконка: img (ref=e46)
  - Текст: "Список" (generic, ref=e48)
- **Функция:** Переключение на представление "Список" (альтернативный вид отображения статей)
- **Примечание:** В текущем тестировании клик по "Список" не изменил URL, возможно это переключатель представления на той же странице

### 2. Заголовок страницы

#### Элемент:
- **Тип:** heading
- **Level:** 1
- **Ref:** e49
- **Текст:** "Статьи"
- **Расположение:** Под навигацией, слева

### 3. Кнопка "Создать"

#### Элемент:
- **Тип:** link (ссылка, не кнопка)
- **Ref:** e52
- **URL:** `/manage/1000373-worldwideservices/knowledge-items/create`
- **Текст:** "Создать" (generic, ref=e53)
- **Расположение:** Справа от заголовка
- **Функция:** Переход на отдельную страницу создания новой статьи
- **Поведение:** 
  - При клике происходит **переход на отдельную страницу** (не открывается модальное окно)
  - URL меняется на `/knowledge-items/create`
  - Заголовок страницы меняется на "Создать Статья - GPT Агент"
  - В навигации появляется хлебная крошка "Статьи > Создать"
  - Header и Sidebar остаются видимыми
  - Отображается форма создания статьи со всеми полями

---

## Панель инструментов (Toolbar)

### Структура:
- **Контейнер:** generic (ref=e61)
- **Расположение:** Под заголовком и кнопкой "Создать"

### Элементы панели инструментов:

#### 1. Поле поиска

##### Структура:
- **Контейнер:** generic (ref=e62)
- **Label:** "Поиск" (generic, ref=e63)
- **Поле ввода:** generic (ref=e64)
  - Иконка: img (ref=e66)
  - **Поле:** searchbox "Поиск" (ref=e69)

##### Функциональность:
- **Тип:** searchbox
- **Ref:** e69
- **Placeholder:** "Поиск" (предположительно)
- **Функция:** Поиск статей по тексту
- **Поведение:**
  - При вводе текста обновляется URL с параметром `tableSearch` (например: `?tableSearch=%D1%82%D0%B5%D1%81%D1%82`)
  - Создается активный фильтр "Поиск: [текст]" в блоке "Активные фильтры"
  - Поиск выполняется в реальном времени (без нажатия Enter)
- **Состояния:**
  - Обычное: пустое поле
  - Активное: [active] когда поле в фокусе
  - С текстом: отображает введенный текст

#### 2. Кнопка "Фильтр"

##### Элемент:
- **Тип:** button
- **Ref:** e72 (может меняться, например e266)
- **Содержимое:**
  - Текст: "Фильтр" (generic, ref=e73)
  - Иконка: img (ref=e74)
  - Бейдж: количество активных фильтров (generic, ref=e79)
    - Отображает "1", "0" и т.д. в зависимости от количества примененных фильтров
- **Состояние:** [active] когда модалка фильтров открыта
- **Функция:** Открывает модальное окно с фильтрами

##### Модальное окно фильтров:

**Структура модалки:**
- **Контейнер:** generic (ref=e220 или e70)
- **Расположение:** Открывается справа от кнопки "Фильтр", накладывается поверх контента
- **Тип:** Popover/Dropdown (не полноэкранная модалка)
- **Визуальное оформление:**
  - Белый фон
  - Тень для выделения
  - Скругленные углы

**Заголовок модалки:**
- **Контейнер:** generic (ref=e221)
- **Заголовок:** heading "Фильтры" (level=4, ref=e222)
  - Текст: "Фильтры"
  - Расположение: Слева вверху модалки
- **Кнопка "Сбросить":**
  - Тип: button
  - Ref: e224
  - Текст: "Сбросить" (generic, ref=e225)
  - Расположение: Справа вверху модалки, на уровне заголовка
  - Функция: Сбрасывает все примененные фильтры
  - Поведение:
    - Очищает все выбранные значения фильтров
    - Удаляет все активные фильтры
    - Обновляет URL (удаляет параметры фильтрации)
    - Бейдж на кнопке "Фильтр" обновляется на "0"
    - Блок "Активные фильтры" скрывается

**Фильтры:**

###### Фильтр "Категория":
- **Контейнер:** generic (ref=e232)
- **Label:** "Категория" (generic, ref=e235)
  - Расположение: Сверху поля выбора
  - Текст: "Категория"
- **Поле выбора:** generic (ref=e241 или e260 или e278)
  
  **Состояние 1: Категория выбрана**
  - **Выбранное значение:** generic (ref=e242 или e279)
    - **Контейнер:** generic (ref=e242 или e279)
    - **Текст:** "Общее" (generic, ref=e243 или e280 или e281)
    - **Кнопка удаления:** 
      - Иконка: img (ref=e246 или e283)
      - Тип: generic [cursor=pointer] (ref=e243 или e280)
      - Функция: Удаляет выбранную категорию
      - Поведение: При клике категория удаляется, поле возвращается в состояние "не выбрано"
    - **Скрытое поле:** textbox "tree-category_id-label" (ref=e249 или e286)
    - **Иконка стрелки:** img (ref=e253 или e290)
      - Функция: Открывает dropdown со списком категорий
  
  **Состояние 2: Категория не выбрана**
  - **Поле ввода:** textbox "tree-category_id-label" (ref=e262)
    - Placeholder: "Выбрать категорию"
    - Тип: textbox
    - Функция: Поле для поиска и выбора категории
  - **Иконка стрелки:** img (ref=e266 или e290)
    - Функция: Открывает dropdown со списком категорий

- **Тип:** Tree selector (выбор категории из иерархического списка)
- **Функция:** Фильтрация статей по категории

**Dropdown категорий (при открытии):**
- **Тип:** Dropdown/Popover
- **Содержимое:** Список категорий для выбора
- **Доступные опции (из скриншота):**
  1. **"Общее"** (General)
     - Выделяется синим фоном при выборе
     - Может быть выбрана по умолчанию
  2. **"Техническая документация"** (Technical Documentation)
  3. **"Маркетинг"** (Marketing)
  4. **"Продажи"** (Sales)
  5. **"Поддержка"** (Support)
  6. **"Другое"** (Other)
- **Поведение dropdown:**
  - Открывается при клике на поле выбора или иконку стрелки
  - Показывает список всех доступных категорий
  - При выборе категории:
    - Категория отображается в поле как тег с кнопкой удаления
    - Фильтр применяется автоматически
    - Бейдж на кнопке "Фильтр" обновляется
    - В блоке "Активные фильтры" появляется "Категория: [название]"
    - Dropdown закрывается
  - Закрывается при:
    - Выборе категории
    - Нажатии Escape
    - Клике вне dropdown

**Поведение модалки:**
- **Открытие:**
  - При клике на кнопку "Фильтр"
  - Кнопка "Фильтр" получает состояние [active]
  - Модалка появляется справа от кнопки
- **Закрытие:**
  - Нажатие Escape
  - Клик вне модалки
  - Применение фильтров (автоматически не закрывается, остается открытой)
  - Клик на кнопку "Фильтр" повторно (переключает состояние)
- **Применение фильтров:**
  - Происходит автоматически при выборе значений
  - URL обновляется с параметрами фильтрации
  - Блок "Активные фильтры" обновляется
  - Бейдж на кнопке "Фильтр" обновляется
- **Визуальные детали:**
  - Модалка имеет тень для выделения
  - Белый фон
  - Скругленные углы
  - Адаптивное позиционирование

#### 3. Кнопка "Переключить столбцы"

##### Элемент:
- **Тип:** button
- **Ref:** e82
- **Содержимое:**
  - Текст: "Переключить столбцы" (generic, ref=e83)
  - Иконка: img (ref=e84)
- **Состояние:** [active] когда dropdown открыт
- **Функция:** Открывает dropdown для выбора отображаемых столбцов в таблице

##### Dropdown "Столбцы":

**Структура:**
- **Контейнер:** generic (ref=e80 или e256 или e313)
- **Расположение:** Открывается справа от кнопки "Переключить столбцы", накладывается поверх контента
- **Тип:** Popover/Dropdown (не полноэкранная модалка)
- **Визуальное оформление:**
  - Белый фон
  - Тень для выделения
  - Скругленные углы

**Заголовок dropdown:**
- **Заголовок:** heading "Столбцы" (level=4, ref=e257 или e314)
  - Текст: "Столбцы"
  - Расположение: Сверху dropdown

**Список столбцов:**
- **Контейнер:** generic (ref=e263 или e320)
- **Чекбокс "Дата обновления":**
  - **Тип:** checkbox
  - **Ref:** e264 или e321
  - **Label:** "Дата обновления" (generic, ref=e265 или e322)
  - **Функция:** Показывает/скрывает столбец "Дата обновления" в таблице статей
  - **Состояния:**
    - **Unchecked (не отмечен):** Столбец "Дата обновления" скрыт в таблице
    - **Checked (отмечен):** Столбец "Дата обновления" отображается в таблице
  - **Поведение:**
    - При клике на чекбокс состояние переключается (checked/unchecked)
    - Изменения применяются сразу к таблице
    - Состояние сохраняется между сессиями (предположительно в localStorage)
  - **Визуальное оформление:**
    - Стандартный чекбокс с галочкой при отмеченном состоянии
    - Label справа от чекбокса

**Поведение dropdown:**
- **Открытие:**
  - При клике на кнопку "Переключить столбцы"
  - Кнопка "Переключить столбцы" получает состояние [active]
  - Dropdown появляется справа от кнопки
- **Закрытие:**
  - Нажатие Escape
  - Клик вне dropdown
  - Выбор столбцов (автоматически не закрывается, остается открытым)
  - Клик на кнопку "Переключить столбцы" повторно (переключает состояние)
- **Применение изменений:**
  - Происходит сразу при изменении состояния чекбокса
  - Таблица обновляется в реальном времени
  - Состояние сохраняется (предположительно в localStorage)
- **Визуальные детали:**
  - Dropdown имеет тень для выделения
  - Белый фон
  - Скругленные углы
  - Адаптивное позиционирование
  - Минимальная ширина для удобства чтения

**Примечание:** В текущем тестировании виден только один столбец "Дата обновления". Возможно, есть другие столбцы, которые не отображаются в dropdown, или они управляются другим способом. Для полного тестирования требуется таблица с данными статей.

---

## Блок "Активные фильтры"

### Структура:
- **Контейнер:** generic (ref=e86)
- **Label:** "Активные фильтры" (generic, ref=e88)
- **Расположение:** Под панелью инструментов

### Элементы:

#### 1. Список активных фильтров

##### Структура:
- **Контейнер:** generic (ref=e87)
- **Список фильтров:** generic (ref=e90 или e89)

##### Фильтр "Категория: Общее":
- **Контейнер:** generic (ref=e90 или e219)
- **Текст:** "Категория: Общее" (generic, ref=e92 или e221)
- **Кнопка удаления:**
  - Тип: button
  - Ref: e93 или e222
  - Содержимое:
    - Иконка: img (ref=e94 или e223)
    - Текст: "Удалить фильтр" (generic, ref=e96 или e225)
  - Функция: Удаляет конкретный фильтр
  - Поведение:
    - При клике фильтр удаляется
    - Бейдж на кнопке "Фильтр" обновляется (уменьшается на 1)
    - Если это был последний фильтр, блок "Активные фильтры" скрывается

##### Фильтр "Поиск: [текст]":
- **Контейнер:** generic (ref=e90)
- **Текст:** "Поиск: [введенный текст]" (generic, ref=e92)
- **Кнопка удаления:**
  - Тип: button
  - Ref: e93
  - Функция: Очищает поле поиска и удаляет фильтр
  - Поведение:
    - При клике поле поиска очищается
    - URL обновляется (удаляется параметр `tableSearch`)
    - Фильтр удаляется из списка

**Примечание:** Может быть несколько активных фильтров одновременно (например, "Поиск: тест" и "Категория: Общее")

#### 2. Кнопка очистки всех фильтров

##### Элемент:
- **Тип:** button
- **Ref:** e98
- **Содержимое:**
  - Иконка: img (ref=e99)
- **Функция:** Удаляет все активные фильтры одновременно
- **Поведение:**
  - Очищает поле поиска
  - Сбрасывает все фильтры
  - Обновляет URL (удаляет все параметры фильтрации)
  - Скрывает блок "Активные фильтры"

---

## Область контента

### Структура:
- **Контейнер:** generic (ref=e57)
- **Внутренний контейнер:** generic (ref=e58)

### Состояния:

#### 1. Состояние "Не найдено"

##### Структура:
- **Контейнер:** generic (ref=e103 или e267)
- **Иконка:** img (ref=e105 или e269)
- **Заголовок:** heading "Не найдено Статьи" (level=4, ref=e107 или e271)

##### Когда отображается:
- Когда нет статей, соответствующих примененным фильтрам
- Когда список статей пуст
- После поиска, который не дал результатов

#### 2. Состояние "Таблица статей"

**Примечание:** В текущем тестировании таблица статей не отображалась (список пуст). Структура таблицы будет описана на основе общих паттернов и доступных элементов управления столбцами.

**Предполагаемая структура таблицы:**
- Заголовки столбцов (настраиваемые через "Переключить столбцы")
- Строки с данными статей
- Возможные столбцы:
  - Название/Заголовок (обязательный)
  - Категория
  - Дата обновления (опциональный, управляется через "Переключить столбцы")
  - Статус (Активно/Неактивно)
  - Действия (редактирование, удаление)

---

## Страница создания/редактирования статьи

### ⚠️ ВАЖНО: Это отдельная страница, НЕ модальное окно!

При нажатии на кнопку "Создать" происходит:
- **Переход на отдельную страницу** (не открывается модальное окно)
- **Изменение URL:** с `/knowledge-items` на `/knowledge-items/create`
- **Изменение заголовка страницы:** с "Статьи - GPT Агент" на "Создать Статья - GPT Агент"
- **Обновление навигации:** появляется хлебная крошка "Статьи > Создать"
- **Сохранение Header и Sidebar:** они остаются видимыми на странице

### URL
`https://aai.widgets.wearekwid.com/manage/1000373-worldwideservices/knowledge-items/create`

### Title (Заголовок страницы)
"Создать Статья - GPT Агент"

### Навигация страницы (Хлебные крошки)

#### Структура:
- **Контейнер:** navigation (ref=e41)
- **Список:** list (ref=e42)

#### Элементы:

##### 1. Ссылка "Статьи"
- **Тип:** link
- **Ref:** e44
- **URL:** `/manage/1000373-worldwideservices/knowledge-items`
- **Функция:** Возврат к списку статей

##### 2. Текущая страница "Создать"
- **Тип:** listitem
- **Ref:** e45
- **Содержимое:**
  - Иконка: img (ref=e46)
  - Текст: "Создать" (generic, ref=e48)
- **Состояние:** active (текущая страница)

### Заголовок страницы

#### Элемент:
- **Тип:** heading
- **Level:** 1
- **Ref:** e49
- **Текст:** "Создать Статья"

### Форма создания статьи

#### Структура:
- **Контейнер:** generic (ref=e52)
- **Форма:** generic (ref=e58)

#### Поля формы:

##### 1. Поле "Заголовок"

**Структура:**
- **Контейнер:** generic (ref=e61)
- **Label:**
  - Текст: "Заголовок" (generic, ref=e64)
  - Обязательное поле: superscript "*" (ref=e65)
- **Поле ввода:**
  - Тип: textbox
  - Ref: e69
  - Label: "Заголовок*"
  - Обязательное: Да (обозначено звездочкой)
- **Функция:** Ввод названия статьи
- **Валидация:** Обязательное поле

##### 2. Переключатель "Активно"

**Структура:**
- **Контейнер:** generic (ref=e74)
- **Элемент:**
  - Тип: switch
  - Ref: e75
  - Состояние: [checked] (по умолчанию включено)
  - Label: "Активно" (generic, ref=e76)
- **Функция:** Включает/выключает статью (активная статья доступна для использования агентом)
- **Поведение:** Переключатель (toggle switch)

##### 3. Поле "Категории"

**Структура:**
- **Контейнер:** generic (ref=e69)
- **Label:**
  - Текст: "Категории" (generic, ref=e72)
  - Обязательное поле: superscript "*" (ref=e73)
- **Поле выбора:** generic (ref=e79)
  - **Выбранное значение (если выбрано):** generic (ref=e80)
    - Текст: "Общее" (generic, ref=e81 или e82)
    - Иконка: img (ref=e84 или e94)
    - Тип: generic [cursor=pointer] (ref=e81)
    - Функция: Показывает выбранную категорию, клик открывает dropdown
  - **Поле ввода:** textbox "tree-categories-label" (ref=e87)
    - Placeholder: "Выбрать категории"
    - Состояние: [active] когда dropdown открыт
    - Функция: Поле для поиска/выбора категорий
  - **Иконка стрелки:** img (ref=e91 или e101)
    - Функция: Индикатор dropdown
- **Тип:** Tree selector (выбор категории из иерархического списка)
- **Обязательное:** Да (обозначено звездочкой)
- **Функция:** Выбор категории для статьи

**Dropdown категорий (Tree Selector):**

**Структура dropdown:**
- **Контейнер:** generic (ref=e78)
- **Тип:** Popover/Dropdown с иерархическим списком
- **Расположение:** Открывается под полем выбора категорий

**Содержимое dropdown:**
- **Элемент категории "Общее":**
  - Тип: generic [cursor=pointer] (ref=e270)
  - Содержимое:
    - Checkbox: generic (checkbox для выбора)
    - Текст: "Общее" (generic)
  - Функция: Выбор категории "Общее"
  - Поведение:
    - При клике на checkbox категория выбирается
    - При клике на текст также происходит выбор
    - Выбранная категория отображается в поле выше

**Поведение dropdown:**
- **Открытие:**
  - При клике на поле "tree-categories-label"
  - При клике на выбранное значение (если есть)
  - При клике на иконку стрелки
- **Закрытие:**
  - Нажатие Escape
  - Клик вне dropdown
  - Выбор категории (автоматически закрывается)
- **Поиск:**
  - Возможен поиск по названию категории в поле "tree-categories-label"
  - Результаты фильтруются в реальном времени
- **Визуальные детали:**
  - Dropdown имеет тень для выделения
  - Белый фон
  - Скругленные углы
  - Иерархическая структура (tree) для вложенных категорий

##### 4. Поле "Связанные статьи"

**Структура:**
- **Контейнер:** generic (ref=e95)
- **Label:** "Связанные статьи" (generic, ref=e98)
- **Поле выбора:** generic (ref=e99)
  - **Combobox:**
    - Тип: combobox
    - Ref: e103
    - Состояние: [expanded] когда dropdown открыт
    - **Поле ввода:**
      - Тип: textbox
      - Ref: e105
      - Placeholder: "Найдите и выберите связанные статьи..."
      - Состояние: [active] когда поле активно
      - Функция: Поиск и выбор связанных статей
  - **Описание:** generic (ref=e106)
    - Текст: "Когда агент находит эту статью, он также использует связанные статьи для предоставления более полного ответа."
- **Функция:** Выбор связанных статей, которые будут использоваться вместе с текущей статьей

**Dropdown "Связанные статьи" (Combobox):**

**Структура dropdown:**
- **Контейнер:** listbox (ref=e265)
- **Тип:** Combobox с поиском
- **Расположение:** Открывается под полем ввода

**Содержимое dropdown:**
- **Сообщение при открытии:**
  - Текст: "Введите текст для поиска..." (generic, ref=e266)
  - Функция: Подсказка пользователю начать ввод для поиска статей
  - Отображается: Когда dropdown открыт, но поиск еще не начат

**Поведение dropdown:**
- **Открытие:**
  - При клике на поле "Найдите и выберите связанные статьи..."
  - При фокусе на поле ввода
  - Combobox получает состояние [expanded]
- **Поиск:**
  - При вводе текста в поле выполняется поиск статей
  - Результаты отображаются в listbox в реальном времени
  - Поиск происходит по названию/содержимому статей
- **Выбор:**
  - Множественный выбор (можно выбрать несколько статей)
  - Выбранные статьи отображаются как теги/чипсы
  - Можно удалить выбранную статью кликом на крестик
- **Закрытие:**
  - Нажатие Escape
  - Клик вне dropdown
  - После выбора статьи (опционально, может оставаться открытым для множественного выбора)
- **Визуальные детали:**
  - Dropdown имеет тень для выделения
  - Белый фон
  - Скругленные углы
  - Адаптивная высота в зависимости от количества результатов

##### 5. Поле "Содержимое"

**Структура:**
- **Контейнер:** generic (ref=e119)
- **Label:**
  - Текст: "Содержимое" (generic, ref=e122)
  - Обязательное поле: superscript "*" (ref=e123)
- **Поле ввода:**
  - Тип: textbox
  - Ref: e128
  - Label: "Содержимое*"
  - Обязательное: Да (обозначено звездочкой)
- **Функция:** Ввод основного текста статьи
- **Валидация:** Обязательное поле
- **Тип:** Многострочное текстовое поле (textarea)

##### 6. Блок "Отправить файлы"

**Структура:**
- **Контейнер:** generic (ref=e131)
- **Label:** "Отправить файлы" (generic, ref=e134)
- **Поле загрузки:** generic (ref=e135)
  - **Group "Отправить файлы":**
    - Тип: group
    - Ref: e136
    - **Контейнер:** generic (ref=e138)
      - **Кнопка загрузки:**
        - Тип: button
        - Ref: e139
        - Текст: "Перетащите файлы или выберите" (generic, ref=e262)
      - **Alert:** alert (ref=e140)
      - **Список файлов:** list
- **Описание:** generic (ref=e141)
  - Текст: "Эти файлы (изображения, аудио, видео или документы) будут отправлены клиентам, когда Агент ИИ использует эту статью в ответе. Если используются несколько статей, отправляются файлы из наиболее релевантной статьи."

**Функциональность:**
- **Drag & Drop:** Поддержка перетаскивания файлов
- **Выбор файлов:** Клик по кнопке открывает диалог выбора файлов
- **Типы файлов:** Изображения, аудио, видео, документы
- **Поведение:** 
  - Файлы отображаются в списке после загрузки
  - Можно удалить загруженные файлы
  - Файлы прикрепляются к статье

### Кнопки действий формы

#### Структура:
- **Контейнер:** generic (ref=e143)
- **Расположение:** Внизу формы

#### Элементы:

##### 1. Кнопка "Создать"
- **Тип:** button
- **Ref:** e144
- **Текст:** "Создать" (generic, ref=e145)
- **Функция:** Сохраняет статью и возвращает к списку статей
- **Поведение:**
  - Валидирует обязательные поля
  - Сохраняет статью в базу данных
  - Перенаправляет на страницу списка статей
  - Показывает уведомление об успешном создании

##### 2. Кнопка "Создать и Создать еще"
- **Тип:** button
- **Ref:** e146
- **Текст:** "Создать и Создать еще" (generic, ref=e147)
- **Функция:** Сохраняет статью и очищает форму для создания новой
- **Поведение:**
  - Валидирует обязательные поля
  - Сохраняет статью
  - Очищает форму (кроме выбранных значений по умолчанию)
  - Остается на странице создания
  - Показывает уведомление об успешном создании

##### 3. Кнопка "Отмена"
- **Тип:** button
- **Ref:** e148
- **Текст:** "Отмена" (generic, ref=e149)
- **Функция:** Отменяет создание и возвращает к списку статей
- **Поведение:**
  - Закрывает форму без сохранения
  - Возвращает на страницу списка статей
  - Если были внесены изменения, может показывать подтверждение

---

## Технические детали для реализации

### URL параметры:

1. **Поиск:**
   - Параметр: `tableSearch`
   - Пример: `?tableSearch=%D1%82%D0%B5%D1%81%D1%82` (URL-encoded "тест")
   - Функция: Фильтрация статей по тексту поиска

2. **Фильтры:**
   - Параметры могут включать:
     - `category_id` - ID категории
     - Другие параметры фильтрации (требует дополнительного тестирования)

### Состояния элементов:

1. **Кнопка "Фильтр":**
   - Обычное: показывает количество активных фильтров
   - Активное: [active] когда модалка открыта
   - Бейдж обновляется динамически

2. **Кнопка "Переключить столбцы":**
   - Обычное: показывает иконку
   - Активное: [active] когда dropdown открыт

3. **Поле поиска:**
   - Обычное: пустое поле
   - Активное: [active] когда в фокусе
   - С текстом: отображает введенный текст

4. **Блок "Активные фильтры":**
   - Видимый: когда есть хотя бы один активный фильтр
   - Скрытый: когда нет активных фильтров

### Валидация формы создания статьи:

1. **Обязательные поля:**
   - Заголовок (обозначено *)
   - Категории (обозначено *)
   - Содержимое (обозначено *)

2. **Опциональные поля:**
   - Активно (по умолчанию включено)
   - Связанные статьи
   - Отправить файлы

### Логика работы фильтров:

1. **Применение фильтров:**
   - Фильтры применяются автоматически при выборе значений
   - URL обновляется с параметрами фильтрации
   - Блок "Активные фильтры" обновляется

2. **Удаление фильтров:**
   - Индивидуальное удаление через кнопку "Удалить фильтр"
   - Массовое удаление через кнопку очистки всех фильтров
   - При удалении URL обновляется

3. **Сброс фильтров:**
   - Кнопка "Сбросить" в модалке фильтров сбрасывает все фильтры
   - Кнопка очистки всех фильтров также сбрасывает все фильтры

---

## Визуальные детали

### Расположение элементов:

1. **Навигация и заголовок:**
   - Навигация (Статьи/Список) - слева
   - Заголовок "Статьи" - слева, под навигацией
   - Кнопка "Создать" - справа, на уровне заголовка

2. **Панель инструментов:**
   - Поле поиска - слева
   - Кнопка "Фильтр" - по центру
   - Кнопка "Переключить столбцы" - справа
   - Все элементы в одной строке

3. **Блок "Активные фильтры":**
   - Под панелью инструментов
   - Горизонтальное расположение фильтров
   - Кнопка очистки всех фильтров - справа

4. **Область контента:**
   - Под блоком "Активные фильтры"
   - По центру страницы

### Адаптивность:

- Все элементы адаптируются под размер экрана
- На мобильных устройствах элементы могут перестраиваться в вертикальный список

---

## Резюме протестированных элементов

### ✅ Полностью протестировано:

1. **Навигация страницы:**
   - Ссылка "Статьи"
   - Ссылка "Список"

2. **Заголовок и кнопка "Создать":**
   - Заголовок "Статьи"
   - Кнопка "Создать" с редиректом на страницу создания

3. **Панель инструментов:**
   - Поле поиска с функциональностью
   - Кнопка "Фильтр" с модалкой
   - Кнопка "Переключить столбцы" с dropdown

4. **Блок "Активные фильтры":**
   - Отображение активных фильтров
   - Кнопки удаления отдельных фильтров
   - Кнопка очистки всех фильтров

5. **Состояние "Не найдено":**
   - Иконка и заголовок при отсутствии результатов

6. **Страница создания статьи:**
   - Все поля формы
   - Валидация обязательных полей
   - Кнопки действий

### ⏳ Требует дополнительного тестирования:

1. **Таблица статей:**
   - Структура таблицы с данными
   - Действия над статьями (редактирование, удаление)
   - Пагинация (если есть)
   - Сортировка столбцов

2. **Представление "Список":**
   - Альтернативный вид отображения статей
   - Переключение между представлениями

3. **Страница редактирования статьи:**
   - Форма редактирования (аналогична форме создания)
   - Кнопки "Сохранить" и "Сохранить и Создать еще"

4. **Дополнительные фильтры:**
   - Другие возможные фильтры (кроме категории)
   - Комбинирование нескольких фильтров

---

## Layout и Spacing

### Общая структура страницы
- **Максимальная ширина контента:** 1200px (центрирован)
- **Отступы от краев:** 24px (desktop), 16px (tablet), 12px (mobile)
- **Отступ между Header и Main Content:** 24px
- **Отступ между Sidebar и Main Content:** 24px

### Разделение секций
- **Отступ между секциями:** 24px (вертикальный)
- **Отступ между элементами в Toolbar:** 16px (горизонтальный)
- **Отступ между строками таблицы:** 8px (вертикальный)

---

## Компонентная карта страницы

### Полный список компонентов на странице "Статьи"

#### Основная страница (`/knowledge-items`)
1. **Breadcrumbs** - навигация страницы
   - **Link** - "Статьи"
   - **Link** - "Список"
2. **Heading (h1)** - "Статьи"
3. **Button** - "Создать"
4. **Toolbar** - панель инструментов
   - **Searchbox** - поле поиска
   - **Button** - "Фильтр"
   - **Button** - "Переключить столбцы"
5. **ActiveFilters** - блок активных фильтров
   - **Badge List** - список активных фильтров
   - **Button** - "Очистить все"
6. **ContentArea** - область контента
   - **EmptyState** - состояние "Не найдено"
   - **Table** - таблица статей
     - **TableHeader** - заголовки столбцов
     - **TableRow** - строки таблицы
     - **TableActions** - действия над статьями

#### Страница создания (`/knowledge-items/create`)
1. **Breadcrumbs** - "Статьи > Создать"
2. **Heading (h1)** - "Создать Статья"
3. **Form** - форма создания статьи
   - **Textbox** - "Заголовок"
   - **Textarea** - "Описание"
   - **Combobox** - "Категория"
   - **Textbox** - "Теги"
   - **Switch** - "Опубликовано"
   - **Textarea** - "Содержание"
4. **FormActions** - кнопки действий
   - **Button** - "Сохранить"
   - **Button** - "Сохранить и Создать еще"
   - **Button** - "Отмена"

---

## Визуальное разделение секций

### Структура секции
- **Фон:** #FFFFFF (белый)
- **Тень:** `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
- **Граница:** `border: 1px solid #E5E7EB` (опционально)
- **Скругление:** `border-radius: 8px`
- **Внутренние отступы:** `padding: 24px`

---

## Цветовая палитра

### Основные цвета
- **Фон страницы:** #F9FAFB (светло-серый)
- **Фон карточек:** #FFFFFF (белый)
- **Фон активных фильтров:** #EFF6FF (светло-синий)

### Цвета текста
- **Основной текст:** #111827 (темно-серый)
- **Вторичный текст:** #6B7280 (серый)
- **Текст ошибок:** #DC2626 (красный)

### Цвета элементов
- **Кнопки Primary:** #3B82F6 (синий)
- **Бейджи фильтров:** #3B82F6 (синий фон, белый текст)
- **Ссылки:** #3B82F6 (синий)

---

## Типографика

### Шрифт
- **Семейство:** System font stack
- **Базовый размер:** 16px
- **Line height:** 1.5 (24px)

### Заголовки
- **H1:** 32px, 700 (bold), #111827
- **H2:** 24px, 700 (bold), #111827
- **Table Header:** 14px, 600 (semi-bold), #6B7280

---

## Иконки и их расположение

### Размеры иконок
- **Иконки в Toolbar:** 20px × 20px
- **Иконки в таблице:** 16px × 16px
- **Иконки в формах:** 20px × 20px

---

## Grid система и Layout

### Общая структура
- **Container:** max-width: 1200px, margin: 0 auto
- **Grid columns:** 12 колонок (desktop)
- **Gap между колонками:** 24px

---

## Анимации и переходы

### Длительности
- **Быстрые переходы:** 150ms (hover эффекты)
- **Стандартные переходы:** 200ms (переключение фильтров)
- **Медленные переходы:** 300ms (раскрытие модалов)

### Easing функции
- **Стандартный:** ease-in-out
- **Smooth:** cubic-bezier(0.4, 0, 0.2, 1)

---

## Пустые состояния и Edge Cases

### Edge Cases

#### Нет статей
- **Отображение:** EmptyState с текстом "Не найдено"
- **Кнопка:** "Создать" для создания первой статьи

#### Очень длинные заголовки
- **Обработка:** Обрезка текста с многоточием
- **Tooltip:** Полный текст при hover

---

## Список всех компонентов для реализации

### Базовые компоненты
1. **Heading** - заголовки
2. **Button** - кнопки
3. **Link** - ссылки
4. **Searchbox** - поле поиска
5. **Combobox** - выпадающие списки
6. **Textbox** - текстовые поля
7. **Textarea** - многострочные поля
8. **Switch** - переключатели
9. **Table** - таблицы
10. **Badge** - бейджи
11. **Modal** - модальные окна
12. **Form** - формы

---

## API спецификации (детальные)

### Базовый URL
- **Production:** `https://aai.widgets.wearekwid.com/api`
- **Development:** `http://localhost:3000/api`

### Аутентификация
- **Тип:** Bearer Token (JWT)
- **Header:** `Authorization: Bearer {token}`

### Endpoints для страницы "Статьи"

#### 1. Получение списка статей
```
GET /api/knowledge-items
Query Parameters:
  - search: string (optional)
  - categoryId: number (optional)
  - page: number (optional, default: 1)
  - limit: number (optional, default: 10)
  - sortBy: string (optional, default: "createdAt")
  - sortOrder: "asc" | "desc" (optional, default: "desc")

Response 200:
{
  "data": {
    "items": [
      {
        "id": number,
        "title": "string",
        "description": "string",
        "categoryId": number,
        "categoryName": "string",
        "tags": string[],
        "isPublished": boolean,
        "createdAt": "ISO 8601",
        "updatedAt": "ISO 8601"
      }
    ],
    "pagination": {
      "page": number,
      "limit": number,
      "total": number,
      "totalPages": number
    }
  }
}
```

#### 2. Создание статьи
```
POST /api/knowledge-items
Body:
{
  "title": "string",
  "description": "string",
  "categoryId": number,
  "tags": string[],
  "isPublished": boolean,
  "content": "string"
}

Response 201:
{
  "data": {
    "id": number,
    "title": "string",
    ...
  }
}
```

#### 3. Обновление статьи
```
PUT /api/knowledge-items/:id
Body: (аналогично созданию)

Response 200:
{
  "data": {
    "id": number,
    ...
  }
}
```

#### 4. Удаление статьи
```
DELETE /api/knowledge-items/:id

Response 204: No Content
```

### Rate Limiting
- **Стандартные запросы:** 100 запросов в минуту

### Коды ошибок
- **200:** Успешный запрос
- **201:** Создано
- **204:** Успешно удалено
- **400:** Неверный запрос
- **401:** Не авторизован
- **403:** Нет доступа
- **404:** Не найдено
- **500:** Внутренняя ошибка сервера

---

## Детальные состояния загрузки

### Skeleton Loaders

#### Таблица статей
- **Структура:** 10 строк с placeholder'ами
- **Анимация:** Пульсация (shimmer effect)
- **Высота строки:** 60px

#### Форма создания
- **Структура:** Placeholder'ы для всех полей
- **Анимация:** Пульсация

---

## Responsive Design (точные breakpoints)

### Breakpoints
- **Mobile:** ≤ 767px
- **Tablet:** 768px - 1023px
- **Desktop:** ≥ 1024px
- **Large Desktop:** ≥ 1440px

### Адаптация компонентов

#### Таблица
- **Desktop:** Все столбцы видны
- **Tablet:** Скрыты некоторые столбцы
- **Mobile:** Карточный вид вместо таблицы

---

## Z-index слои

### Порядок наложения
1. **Base content:** z-index: 1
2. **Toolbar:** z-index: 10
3. **Dropdowns:** z-index: 200
4. **Modals:** z-index: 1000

---

## Focus states (детальные)

### Визуальные индикаторы
- **Цвет:** #3B82F6 (синий)
- **Толщина:** 2px
- **Стиль:** solid
- **Offset:** 2px (outline-offset)

---

## Hover/Active/Pressed states

### Строки таблицы
- **Hover:**
  - background-color: #F9FAFB
  - transition: 150ms

### Кнопки
- **Hover:**
  - background-color: #2563EB (темнее на 10%)
  - transition: 150ms

---

## Тени и эффекты (точные значения)

### Тени
- **Карточки:** `box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)`
- **Dropdowns:** `box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)`
- **Modals:** `box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1)`

---

## Скругления (точные значения)

### Компоненты
- **Карточки:** border-radius: 8px
- **Кнопки:** border-radius: 6px
- **Inputs:** border-radius: 6px
- **Badges:** border-radius: 12px

---

## Шрифты

### Семейство шрифтов
- **Основной:** System font stack
  - `-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif`

### Размеры
- **Base:** 16px
- **Small:** 14px
- **Large:** 18px
- **XLarge:** 24px
- **XXLarge:** 32px

---

## Иконки (детальные требования)

### Библиотека
- **Рекомендуется:** Lucide React, Heroicons, или аналогичная
- **Формат:** SVG
- **Размеры:** 16px, 20px, 24px

### Иконки по элементам
- **Поиск:** Search
- **Фильтр:** Filter
- **Столбцы:** Columns
- **Создать:** Plus
- **Редактировать:** Edit
- **Удалить:** Trash
- **Отмена:** X
- **Сохранить:** Check

---

## Бизнес-логика

### Валидация формы
- **Заголовок:** Обязательное поле, минимум 1 символ, максимум 255 символов
- **Описание:** Опциональное, максимум 1000 символов
- **Категория:** Обязательное поле
- **Теги:** Опциональное, массив строк
- **Содержание:** Обязательное поле, минимум 10 символов

### Фильтрация
- **Поиск:** По заголовку и описанию
- **По категории:** Точное совпадение
- **Комбинирование:** Поиск + категория одновременно

---

## Обработка ошибок (детальная)

### Типы ошибок
- **Ошибки валидации:** Отображение под полем формы
- **API ошибки:** Toast уведомления
- **Ошибки загрузки:** Отображение сообщения об ошибке

---

## Производительность

### Оптимизации
- **Кэширование:** Список статей кэшируется на 5 минут
- **Ленивая загрузка:** Категории загружаются по требованию
- **Виртуализация:** Для больших списков статей

---

## Безопасность

### Аутентификация
- **JWT токены:** Хранятся в httpOnly cookies

### Авторизация
- **RBAC:** Role-Based Access Control
- **Проверка прав:** На создание, редактирование, удаление статей

---

## Тестирование

### Unit тесты
- **Компоненты:** React Testing Library
- **Покрытие:** Минимум 80%

### E2E тесты
- **Сценарии:**
  - Создание статьи
  - Редактирование статьи
  - Удаление статьи
  - Фильтрация статей
  - Поиск статей

---

## Примеры кода

### Компонент таблицы статей
```typescript
import { useQuery } from '@tanstack/react-query';

interface Article {
  id: number;
  title: string;
  description: string;
  categoryName: string;
  isPublished: boolean;
  createdAt: string;
}

export function ArticlesTable() {
  const { data, isLoading, error } = useQuery({
    queryKey: ['articles'],
    queryFn: () => fetchArticles(),
  });

  if (isLoading) return <ArticlesTableSkeleton />;
  if (error) return <ErrorMessage error={error} />;
  if (!data?.data.items.length) return <EmptyState />;

  return (
    <table>
      <thead>
        <tr>
          <th>Заголовок</th>
          <th>Категория</th>
          <th>Опубликовано</th>
          <th>Дата создания</th>
          <th>Действия</th>
        </tr>
      </thead>
      <tbody>
        {data.data.items.map((article) => (
          <tr key={article.id}>
            <td>{article.title}</td>
            <td>{article.categoryName}</td>
            <td>{article.isPublished ? 'Да' : 'Нет'}</td>
            <td>{formatDate(article.createdAt)}</td>
            <td>
              <Button onClick={() => editArticle(article.id)}>
                Редактировать
              </Button>
              <Button onClick={() => deleteArticle(article.id)}>
                Удалить
              </Button>
            </td>
          </tr>
        ))}
      </tbody>
    </table>
  );
}
```

---

## Логирование и мониторинг

### Что логировать
- **Создание статьи:** ID статьи, заголовок
- **Редактирование статьи:** ID статьи, измененные поля
- **Удаление статьи:** ID статьи
- **Поиск:** Поисковый запрос, количество результатов
- **Фильтрация:** Примененные фильтры

---

## Доступность (расширенная)

### ARIA атрибуты
- **aria-label:** Для всех интерактивных элементов
- **aria-describedby:** Для полей формы с описаниями
- **aria-invalid:** Для полей с ошибками
- **role="table":** Для таблицы

### Keyboard navigation
- **Tab:** Навигация по элементам
- **Enter/Space:** Активация элемента
- **Escape:** Закрытие модалов

---

## Интернационализация (i18n)

### Поддерживаемые языки
- **Основной:** Русский (ru)

### Форматирование
- **Даты:** Формат зависит от локали
- **Числа:** Формат зависит от локали

---

## Деплой и окружения

### Окружения
- **Development:** `http://localhost:3000`
- **Staging:** `https://staging.aai.widgets.wearekwid.com`
- **Production:** `https://aai.widgets.wearekwid.com`

---

## Версионирование API

### Формат версий
- **Текущая версия:** v1
- **Формат:** `/api/v1/knowledge-items`

---

## Документация для пользователей

### Tooltips и подсказки
- **Кнопка "Создать":** "Создать новую статью"
- **Поле поиска:** "Поиск по заголовку и описанию"
- **Кнопка "Фильтр":** "Применить фильтры к списку статей"

---

**Дата создания отчета:** 2025-11-11
**Дата последнего обновления:** 2025-01-26
**Версия:** 4.0
**Статус:** Полностью протестировано и детализировано для репликации

